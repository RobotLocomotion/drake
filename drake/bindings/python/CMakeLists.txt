set(DRAKE_INSTALL_PYTHON_DIR
  "${DRAKE_LIBRARY_DIR}/python${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR}/dist-packages")

file(RELATIVE_PATH RELATIVE_PATH_PYDRAKE_DRAKE
  "${DRAKE_INSTALL_PYTHON_DIR}/pydrake" "${PROJECT_SOURCE_DIR}")

configure_file(autogenerated_path.py.in autogenerated_path.py @ONLY)

install(DIRECTORY pydrake DESTINATION ${DRAKE_INSTALL_PYTHON_DIR})

# set(PYDRAKE_SRCS
#   pydrake/__init__.py
#   # pydrake/autodiffutils.py
#   # pydrake/insource_path.py
#   pydrake/rbtree.py
#   "${CMAKE_CURRENT_BINARY_DIR}/autogenerated_path.py")

# install(FILES ${PYDRAKE_SRCS}
#   DESTINATION "${DRAKE_INSTALL_PYTHON_DIR}/pydrake")

# set(PYDRAKE_SOLVERS_SRCS
#   pydrake/solvers/__init__.py
#   pydrake/solvers/ik.py)

# install(FILES ${PYDRAKE_SOLVERS_SRCS}
#   DESTINATION "${DRAKE_INSTALL_PYTHON_DIR}/pydrake/solvers")

if(BUILD_TESTING)
  # Libraries built from sources generated by SWIG via swigmake.
  # TODO(jamiesnape): Fix swigmake, so we do not have to hard-code the paths.
  # set(PYDRAKE_REQUIRED_FILES
  #   pydrake/_autodiffutils.so
  #   pydrake/_rbtree.so
  #   pydrake/solvers/_ik.so)

  function(drake_add_python_test module_name)
    drake_add_test(NAME test_python_${module_name}
      COMMAND "${PYTHON_EXECUTABLE}" -m unittest ${module_name})
      # WORKING_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}")
    set_tests_properties(test_python_${module_name} PROPERTIES ENVIRONMENT "PYTHONPATH=$PYTHONPATH:${DRAKE_INSTALL_PYTHON_DIR}")
    # set_tests_properties(test_python_${module_name} PROPERTIES
    #   REQUIRED_FILES "${PYDRAKE_REQUIRED_FILES}")
  endfunction()

  if(snopt_FOUND)
    drake_add_python_test(pydrake.test.testRBTIK)
    drake_add_python_test(pydrake.test.testPR2IK)
  endif()

  drake_add_python_test(pydrake.test.test_urdf_parser)
  drake_add_python_test(pydrake.test.testRBTTransformPoints)
  drake_add_python_test(pydrake.test.testRBTCoM)
endif()
