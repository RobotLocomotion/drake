pods_install_python_packages(${CMAKE_CURRENT_SOURCE_DIR}/pydrake)

file(RELATIVE_PATH path_from_python_install_to_drake "${DRAKE_LIBRARY_DIR}/python${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR}/dist-packages/pydrake" ${CMAKE_CURRENT_SOURCE_DIR}/../..)
file(WRITE "${DRAKE_LIBRARY_DIR}/python${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR}/dist-packages/pydrake/autogenerated_path.py" "import os.path\n"
  "def getDrakePath():\n"
  "    return os.path.realpath(os.path.join(os.path.dirname(__file__), '${path_from_python_install_to_drake}'))\n")

if(BUILD_TESTING)
  function(drake_add_python_test module_name)
    drake_add_test(NAME test_python_${module_name}
      COMMAND ${PYTHON_EXECUTABLE} -m unittest ${module_name}
      WORKING_DIRECTORY "${DRAKE_LIBRARY_DIR}/python${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR}/dist-packages")
  endfunction()

  if(snopt_FOUND)
    drake_add_python_test(pydrake.test.testRBTIK)
    drake_add_python_test(pydrake.test.testPR2IK)
  endif()
  drake_add_python_test(pydrake.test.testRBTTransformPoints)
  drake_add_python_test(pydrake.test.testRBTCoM)
endif()
