set(DRAKE_INSTALL_PYTHON_DIR
  "${DRAKE_LIBRARY_DIR}/python${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR}/dist-packages")

file(RELATIVE_PATH RELATIVE_PATH_PYDRAKE_DRAKE
  "${DRAKE_INSTALL_PYTHON_DIR}/pydrake" "${PROJECT_SOURCE_DIR}")

configure_file(autogenerated_path.py.in autogenerated_path.py @ONLY)

install(DIRECTORY pydrake DESTINATION ${DRAKE_INSTALL_PYTHON_DIR})
install(FILES ${CMAKE_CURRENT_BINARY_DIR}/autogenerated_path.py DESTINATION ${DRAKE_INSTALL_PYTHON_DIR}/pydrake)

if(BUILD_TESTING)
  function(drake_add_python_test module_name)
    drake_add_test(NAME test_python_${module_name}
      COMMAND "${PYTHON_EXECUTABLE}" -m unittest ${module_name})
    set_tests_properties(test_python_${module_name} PROPERTIES ENVIRONMENT "PYTHONPATH=$PYTHONPATH:${DRAKE_INSTALL_PYTHON_DIR}")
  endfunction()

  if(snopt_FOUND)
    drake_add_python_test(pydrake.test.testRBTIK)
    drake_add_python_test(pydrake.test.testPR2IK)
  endif()

  drake_add_python_test(pydrake.test.test_urdf_parser)
  drake_add_python_test(pydrake.test.testRBTTransformPoints)
  drake_add_python_test(pydrake.test.testRBTCoM)
  drake_add_python_test(pydrake.test.testForwardDiff)

  if(gurobi_FOUND)
    drake_add_python_test(pydrake.test.testMathematicalProgram)
    drake_add_python_test(pydrake.test.testGurobiSolver)
  endif()

  if(mosek_FOUND)
    drake_add_python_test(pydrake.test.testMosekSolver)
  endif()
endif()
