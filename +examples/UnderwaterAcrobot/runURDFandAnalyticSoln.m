function runURDFandAnalyticSoln()
% Validation study for added mass and buoyancy: 
% Simulates the passive dynamics of both the UnderWaterAcrobot plant 
% (EOM derived from Lagrange by hand) to the solution generated by the 
% RigidBodyManipulator solver

x0 = [pi/2;pi/2;0;0];
tmax = 5;

% Simulate RigidBodyManiplator taken from URDF
disp('Running RigidBodyManiplator solution from URDF');
w = warning('off','Drake:RigidBody:SimplifiedCollisionGeometry');
d = PlanarRigidBodyManipulator('UnderwaterAcrobot.urdf');
warning(w);
traj_urdf = simulate(d,[0 tmax],x0);

vd = d.constructVisualizer();
vd.playback(traj_urdf);

% Simulate UnderWaterAcrobot
disp('Running UnderWaterAcrobot solution');
p = UnderwaterAcrobotPlant;
traj_analytic = simulate(p,[0 tmax],x0);

vp = UnderwaterAcrobotVisualizer(p);
playback(vp,traj_analytic);

% Plot and Compare
dt = tmax/100;
t = [0:dt:tmax];
xt_urdf = traj_urdf.eval(t);
xt_analytic = traj_analytic.eval(t);

figure;
hold on;
plot(t,xt_urdf)
plot(t,xt_analytic,'.')

end
