*************
Drake v0.22.0
*************

Announcements
-------------

TBD

Breaking changes since v0.21.0
------------------------------

* TBD Make set_default_positions an NVI (`#13757`_)

Changes since v0.21.0:
----------------------

Dynamical Systems
~~~~~~~~~~~~~~~~~

New features

* TBD

Fixes

* TBD

Mathematical Program
~~~~~~~~~~~~~~~~~~~~

New features

* TBD

Fixes

* TBD

Multibody Dynamics
~~~~~~~~~~~~~~~~~~

New features

* TBD Implement PlanarMobilizer (`#13711`_)
* TBD Introduce discrete contact pairs for agnostic treatment of discrete contact models (`#13734`_)  # * Introduce discrete pairs in MBP so that TAMSI is agnostic to how pairs are collected. To be noted in the next release: In addition, this PR fixes and old TODO in the Jacobian computation and therefore contact results are expected to change so slightly (in the right direction). Not a breaking change, but probably users should be notified in the next release.
* TBD Make set_default_positions an NVI (`#13757`_)

Fixes

* TBD Fix format in TAMSIs exception message (`#13802`_)

Tutorials and examples
~~~~~~~~~~~~~~~~~~~~~~

* TBD

Miscellaneous features and fixes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* TBD

pydrake bindings
~~~~~~~~~~~~~~~~

New features

* Redirect drake's logs to the Python ``logging`` module instead of stderr (`#13568`_, `#13781`_)

Fixes

* TBD

Newly bound

* TBD

Build system and dependencies
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* Upgrade recommended Bazel version to 3.4 (`#13743`_)
* Upgrade buildifier to latest release 3.4.0 (`#13791`_)
* Upgrade fcl to latest commit (`#13787`_)
* Upgrade fmt to latest release 7.0.2 (`#13788`_)
* Upgrade meshcat to latest commit (`#13755`_)
* Upgrade meshcat_python to latest commit (`#13755`_, `#13806`_)
* Upgrade models to latest commit (`#13786`_)
* Upgrade pybind11 fork to latest commit (`#13801`_)
* Upgrade ros_xacro to latest release 1.13.6 (`#13790`_)
* Upgrade scs to latest release 2.1.2 (`#13789`_)

Newly-deprecated APIs
~~~~~~~~~~~~~~~~~~~~~

* TBD

Removal of deprecated items
~~~~~~~~~~~~~~~~~~~~~~~~~~~

* TBD Remove deprecated code (2020-08) (`#13785`_)

Notes
-----

This release provides `pre-compiled binaries
<https://github.com/RobotLocomotion/drake/releases/tag/v0.22.0>`__ named
``drake-YYYYMMDD-{bionic|focal|mac}.tar.gz``. See :ref:`Nightly Releases
<nightly-releases>` for instructions on how to use them.

Drake binary releases incorporate a pre-compiled version of `SNOPT
<https://ccom.ucsd.edu/~optimizers/solvers/snopt/>`__ as part of the
`Mathematical Program toolbox
<https://drake.mit.edu/doxygen_cxx/group__solvers.html>`__. Thanks to
Philip E. Gill and Elizabeth Wong for their kind support.

..
  Current oldest_commit e6aec974fbca64751e0d35a3eafc739d059e9275 (inclusive).
  Current newest_commit 9d785bacce72f9a9c120dc3b8dc8db73ff957ef3 (inclusive).

* attic,examples,manipulation,multibody,systems,tools: Mow over all XML files with xmllint (`#13768`_)
* common: add symbolic ChebyshevPolynomial (`#13751`_)  # This only implements a univariate Chebyshev polynomial. We will implement the ChebyshevBasis class later, which handles multi-variate Chebyshev basis in the form of T0(x)*T1(y)*T3(z) etc.
* common: yaml: Add EraseMatchingMaps to YamlWriteArchive (`#13699`_)  # This allows for emitting a minimal yaml representation when loaded with retain_map_defaults set on the eventual reader.  This is the minimal API to accomplish that; I intend to provide better usability shims for this in a future commit.
* examples,manipulation,multibody,systems: Simplify SDFormat //pose elements (`#13774`_)  # - Remove `//pose/@frame` when empty - Collapse identity transforms (all zeros) - Remove purely identity transforms ("<pose/>") Script used: https://git.io/JJ2OQ
* examples,manipulation,multibody,systems: models: Have all models use SDFormat 1.7 (`#13758`_)  # * models: Delete unused / untested older versions * models: Remove //version from model.config files Let the models describe themselves * four_bar: Rewind to 1.6 due to usage of //use_parent_model_frame * models: Up-convert all concrete SDFormat files to use 1.7 Procedure, using this WIP setup / script: https://github.com/RobotLocomotion/drake/tree/9465206dfdaeaa54006f9fe5a9da18c261741d37/tmp 1. Run `./tmp/convert.py` 2. Using `git gui`, pick selected +- lines/hunks in the editor * Generally, any changes regarding `//use_parent_model_frame` * Some minor changes collapsing empty tags (e.g. `//link`) 3. Do minor line reordering * models: Update all xacro / rsdf files to 1.7 by hand This should mirror the upgrades in the generated files * Update Python, C++, and world files to SDFormat 1.7 (by hand)
* examples,manipulation: Replace tabs with spaces in xml files (`#13772`_)  # Command: ``` find . \ -name '*.config' \ -o -name '*.rsdf' \ -o -name '*.sdf' \ -o -name '*.urdf' \ -o -name '*.xacro' \ -o -name '*.xml' \ -o -name '*.world' \ | xargs grep -rnI -P '\t' -l \ | xargs sed -e 's#\t#  #g' -e 's# *$##g' -i ```
* examples: Adds support for "planar visualization" in meshcat (`#13755`_)  # And uses it in the ManipulationStation planar demos Also sets a different background color for meshcat (now that I finally can!) to match drake-visualizer.
* geometry: [geometry] Making contact results deterministic (`#13737`_)  # * Making contact results deterministic This encompasses two things: 1. Guarantees that if objects A and B make contact, that the result is identical regardless of which is "first" or "second". 2. For multiple contacts, the results will be ordered in a reliable ordering (for a fixed set of poses). This impacts the following queries documented in QueryObject: - ComputePointPairPenetration() - ComputeContactSurfaces() - ComputeContactSurfacesWithFallback() - FindCollisionCandidates()
* math: math: Declare explicit class instantiations for SO(3) and SE(3) (`#13798`_)
* solvers: Add examples on sum-of-squares (`#13719`_)  # Test sum-of-squares programming with CSDP, Mosek and SCS.
* solvers: Add two more examples on SOS optimization (`#13746`_)
* solvers: CSDP on mac should have a different numerical tolerance (`#13759`_)  # One possible explanation is that they use different BLAS.
* solvers: Fix a bug when customizing the quadratic cost (`#13752`_)
* solvers: MPResult::GetSolution also works for a polynomial (`#13748`_)
* solvers: Relax the tolerance on the Motzkin example for mosek test (`#13765`_)
* third_party,tools: Move `mkdoc.py` from `third_party` (`#13769`_)  # Relocate `mkdoc.py` to the same directory as `mkdoc_comment.py`. Remove the LICENSE file and (now empty) `third_party/com_github_pybind_pybind11` directory. Add copyright information to the two files that are derived from original `mkdoc.py` in pybind11. Resolves #13726
* tools: Add support in one tutorial for Google Colab (`#13697`_)  # * Add setup script to provision colab notebooks Towards #13683
* tools: Reformat text in mkdoc comment text (`#13740`_)  # Follow-up to #13651
* tools: Rename libspdlog.so to libdrake_spdlog.so (`#13698`_)
* tools: sdformat: Add simple interface to `ign sdf` tool (`#13767`_)
* tools: setup_drake_colab avoids reinstall if version info is unchanged (`#13795`_)
