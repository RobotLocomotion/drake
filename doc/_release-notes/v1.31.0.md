---
title: Drake v1.31.0
date: 2099-12-31
released: YYYY-MM-DD
---

# Announcements

* TBD

# Breaking changes since v1.30.0

* TBD
* [breaking change] TBD [multibody,geometry] [multibody] HydroelasticContactInfo<Expression> is empty ([#21618][_#21618])  # Now it only provides for the default lifecycle operations (default constructor, destructor, copy, move, assign) but no longer has any accessors.
* [breaking change newly deprecated] TBD [multibody,lcmtypes] [multibody] ContactResults no longer reports quadrature data ([#21683][_#21683])

Refer to our [Drake Stability Guidelines](/stable.html) for our policy
on API changes.

# Changes since v1.30.0

## Dynamical Systems

<!-- <relnotes for systems go here> -->

* [feature] TBD Add bindings for systems/estimators and acrobot w/ encoders example ([#21610][_#21610])  # This PR adds the missing bindings required to port the examples/acrobot/run_lqr_w_estimator.cc example to python.
* [feature] TBD [framework] Offer warn_deprecated=false option on port getters ([#21631][_#21631])  # This is useful when code wants to scan all ports (and has its own, higher-layer deprecation handler logic).
* [feature] TBD Add ExecuteForcedEvents() ([#21664][_#21664])
* [newly deprecated fix] TBD [systems,examples,manipulation] [systems] Fix VectorSystem terrible computational performance ([#21707][_#21707])  # Output ports were performing scalar conversion during inner loops. Deprecate the defaulted direct_feedthrough constructor argument.

New features

* TBD

Fixes

* TBD

## Mathematical Program

<!-- <relnotes for solvers go here> -->

* [fix] TBD [solvers,geometry,multibody,systems,math] [multibody, solvers] Relaxed tolerances for ARM ([#21713][_#21713])  # * multibody::SpatialVector::IsApprox default tolerance is relaxed. * solvers::UnrevisedLemkeSolver::ComputeZerTolerance() internal tolerance is relaxed. * Numerous unit tests tolerances are relaxed.
* [fix] TBD Use DRAKE_THROW_UNLESS for quadratic cost size check ([#21583][_#21583])
* [fix] TBD [solvers] Fix parsing bugs in OsqpSolver and MosekSolver ([#21579][_#21579])  # Fixes parsing bugs in OsqpSolver and MosekSolver. The changes to OsqpSolver may change the output behavior of OsqpSolver. This commit fixes three bugs. 1.) A parsing bug in OsqpSolver which sometimes led to the wrong optimization program being solved by OsqpSolver.  Valid programs encountering this bug would have silently solved the incorrect problem. 2.) A parsing bug in OsqpSolver which sometimes led to the sometime led to the error  "ERROR in validate_data: P is not upper triangular". Valid programs encountering this bug would have had their result.get_solution_result() set to InvalidInput and not solved. 3.) A parsing bug in MosekSolver which sometimes led to the error "MOSEK error 1415 (MSK_RES_ERR_QOBJ_UPPER_TRIANGLE): Only elements in the lower triangle of the quadratic term in the objective should be specified". Valid program encountering this bug would have had their their result.get_solution_result() set to SolverSpecificError and not solved.
* [feature] TBD [GCS] Support passing an initial_guess to SolveConvexRestriction ([#21506][_#21506])
* [feature] TBD [solvers] Add SemidefiniteRelaxationOptions ([#21500][_#21500])
* [feature] TBD Adds CommonSolverOption::kStandaloneReproductionFileName ([#21607][_#21607])  # and adds support for it to ClarabelSolver.
* [feature] TBD [solvers,common] Parse Lorentz cone constraints from formula ([#21612][_#21612])  # Now we can write, e.g. ``` prog.AddConstraint(y[0] >= np.linalg.norm(x)) ``` and get a Lorentz cone constraint back out.
* [feature] TBD Option to specify a separate solver (and associated solver options) for GCS preprocessing ([#21641][_#21641])
* [feature] TBD [GCS] Support use_in_transcription in AddCost ([#21650][_#21650])  # PR #21179 introduced the ability for constraints in GCS to be applied to subsets of the possible transcriptions. This PR is the follow-up which provides the same functionality when adding costs.
* [feature] TBD Warn the user if the psd constraint has 1 or 2 rows ([#21657][_#21657])  # It is better to impose a linear inequality constraint or rotated Lorentz cone constraint in this case.
* [fix] TBD Allow specifying a subspace along which to draw samples from an HPolyhedron ([#21667][_#21667])
* [feature] TBD Improve the warning message when the Hessian type is indefinite ([#21553][_#21553])
* [feature] TBD [GraphOfConvexSets] Implement support for creating slack variables on edges ([#21403][_#21403])
* [feature] TBD [solvers] Maybe use AABB intersection checks for GCS (#21593) ([#21593][_#21593])  #  By computing the axis-aligned bounding box of each set, we can confirm two sets to be disjoint without having to solve an optimization problem. Given a large graph of convex sets, the computational cost of constructing these bounding boxes may be outweighed by the time savings of solving fewer intersection checks.

New features

* TBD

Fixes

* TBD

## Multibody Dynamics and Geometry

<!-- <relnotes for geometry,multibody go here> -->

* [fix] TBD [solvers,geometry,multibody,systems,math] [multibody, solvers] Relaxed tolerances for ARM ([#21713][_#21713])  # * multibody::SpatialVector::IsApprox default tolerance is relaxed. * solvers::UnrevisedLemkeSolver::ComputeZerTolerance() internal tolerance is relaxed. * Numerous unit tests tolerances are relaxed.
* [fix] TBD [parsing] Fix name clash of collision filter groups ([#21529][_#21529])  # This patch fixes a name clash of collision filter groups when loading the same model multiple times using auto-renaming and plant.RenameModel().
* [fix] TBD [multibody] Filter geometry contacts in MbP not DUM ([#21611][_#21611])  # The user-facing effect of this change is that the contact results output port of a continuous-time multibody plant will no longer contain contact pairs that are filtered due to joint locking.
* [fix] TBD Make prerequisite tickets in MbTS more precise ([#21590][_#21590])  # In particular, avoid using configuration_ticket, kinematics ticket, all_state_ticket, and all_sources_ticket.
* [feature] TBD Parse glTF files into RenderEngineGl ([#21520][_#21520])  # The main work is done by the GltfMeshExtractor defined in internal_render_engine_gl.cc. It extracts data from the glTF file and directly inserts it into RenderEngineGl's various geometry and mesh caches and informs the instantation of those canoncial meshes. This also includes the ability to use textures that are defined in memory instead of reading them from the disk (in support of embedded textures). Further allowances are made for glTF image peculiarity. glTF and OpenGl define the origin of an image at opposite corners. Embedded images need to be flipped to conform to OpenGl.same image stored as an external file Finally, update the supported file format documentation to provide guidance on using glTF files with RenderEngineGl.
* [fix] TBD [geometry] Avoid slowdown of SceneGraph::GetDirectFeedthroughs() ([#21630][_#21630])  # Use an explicit list of dependency tickets in SceneGraph to avoid a pile of useless reifications of proximity geometry. The useless work is triggered if the base class LeafSystem::GetDirectFeedthroughs() implementation falls back on its technique of making a SystemSymbolicInspector, which needs to build an Expression-typed SceneGraph context.
* [fix] TBD Improve accuracy of prerequisite tickets in MbP ([#21589][_#21589])  # In particular, remove all dependencies on all_sources_ticket, all_state_ticket. In addition, replace configuration_ticket and kinematics_ticket with xd_ticket or q/v_ticket depending on whether the plant is discrete or continuous.
* [fix] TBD [multibody,workspace] [Mujoco parser] Don't call CalcSpatialInertia unless needed ([#21665][_#21665])  # Resolves #21648. This defers the call to CalcSpatialInertia until/unless it is actually needed. If inertia values are specified for the body in the xml file, then we don't call CalcSpatialInertia. This allows us to successfully parse models where CalcSpatialInertia fails on the obj, but the calculation was not needed. Adds the Rethink Robotics Sawyer (Apache 2.0) model and Hello Robot Stretch (Clear BSD) to the detail_mujoco_parser_test. For Sawyer parsing fails on this model without the fix in this PR. For Stretch, parsing still fails, for a different reason -- it uses non-uniform scaling on a mesh which we do not support yet -- but at least the IsPhysicallyValid() errors have been resolved.
* [feature] TBD [multibody] Add ContactResults non-default constructor ([#21685][_#21685])  # Users need a way to populate contact results without calling internal functions. We are going to remove the internal functions soon, so now is a good time to add the missing API.
* [fix] TBD Sort the result of ComputeSignedDistancePairwiseClosestPoints ([#21698][_#21698])
* [fix] TBD sort the result of ComputeSignedDistanceToPoint ([#21709][_#21709])

New features

* TBD

Fixes

* TBD

## Planning

<!-- <relnotes for planning go here> -->

* [feature] TBD [GcsTrajOpt] Add Edges accessor to EdgesBetweenSubgraphs ([#21504][_#21504])
* [feature] TBD [GcsTrajOpt] Support symbolic eval of nonconvex derivative constraints ([#21505][_#21505])  # It turns out this was helpful for debugging, even if the primary workflow doesn't use it.
* [feature] TBD Add Energy Cost to KinematicTrajectoryOptimization ([#21587][_#21587])
* [fix] TBD Add tolerance argument to UnwrapToContinousTrajectory, and adjust the default value to 1e-8 ([#21629][_#21629])
* [fix] TBD Fix Segmentation Fault in GcsTrajectoryOptimization::AddRegions ([#21658][_#21658])
* [fix] TBD [planning] Revise CollisionChecker parallel edge checks ([#21645][_#21645])
* [fix] TBD Remove duplicate sort from SceneGraphCollisionChecker ([#21702][_#21702])

New features

* TBD

Fixes

* TBD

## Tutorials and examples

<!-- <relnotes for examples,tutorials go here> -->

* TBD

## Miscellaneous features and fixes

<!-- <relnotes for common,math,lcm,lcmtypes,manipulation,perception,visualization go here> -->

* TBD

## pydrake bindings

<!-- <relnotes for bindings go here> -->

* [fix] TBD Add Python bindings for UnwrapToContinousTrajectory ([#21622][_#21622])

New features

* TBD

Fixes

* TBD

## Build system

<!-- <relnotes for cmake,doc,setup,third_party,tools go here> -->

* [fix] TBD [tools,setup] [wheel] Pin numpy to 1.x ([#21582][_#21582])  # At the moment, pydrake fails during import with NumPy 2.
* [fix] TBD [doc,tools] [setup] Upgrade Bazel to latest release 7.2.1 ([#21676][_#21676])
* [fix] TBD [tools,workspace,examples,setup] Add support for numpy 2.0 ([#21684][_#21684])  # - [workspace] Upgrade pybind11 to latest commit. - Disable Gynmasium-related regression tests on macOS. DrakeGym might not work anymore on macOS. - Update some unit test syntax for latest numpy. - Revert our temporary pin to `numpy < 2`. We no longer constraint numpy at all. - Fix namedview repr to comply with Python's required semantics. Co-authored-by: Jeremy Nimmer <jeremy.nimmer@tri.global>
* TBD

## Build dependencies

<!-- <relnotes for workspace go here> -->

* [fix] TBD [workspace] Upgrade pybind11 to latest commit ([#21584][_#21584])
* [fix] TBD [workspace] Upgrade tinygltf to latest release v2.8.23 ([#21569][_#21569])
* [fix] TBD [workspace,multibody] Add mujoco_menagerie as a test-only dependency ([#21649][_#21649])  # And use it for testing the mujoco parser. Towards 20444 and 21648.
* [fix] TBD [workspace] Upgrade crate_universe to latest ([#21671][_#21671])
* [fix] TBD [workspace] Upgrade abseil_cpp_internal to latest commit ([#21670][_#21670])
* [fix] TBD [workspace] Upgrade mujoco_menagerie_internal to latest commit ([#21670][_#21670])
* [fix] TBD [workspace] Upgrade mypy_internal to latest release v1.10.1 ([#21670][_#21670])
* [fix] TBD [workspace] Upgrade pycodestyle to latest release 2.12.0 ([#21670][_#21670])
* [fix] TBD [workspace] Upgrade ros_xacro_internal to latest release 2.0.11 ([#21670][_#21670])
* [fix] TBD [workspace] Upgrade rules_python to latest release 0.33.2 ([#21670][_#21670])
* [fix] TBD [workspace] Upgrade tinygltf_internal to latest release v2.9.0 ([#21670][_#21670])
* [fix] TBD [workspace] Upgrade typing_extensions_internal to latest release 4.12.2 ([#21670][_#21670])
* [fix] TBD [workspace] Upgrade vtk_internal to latest commit ([#21670][_#21670])
* [fix] TBD Upgrade gz_math_internal and sdformat_internal to latest ([#21674][_#21674])  # Co-Authored-By: Rick Poyner <rick.poyner@tri.global>
* TBD

## Newly-deprecated APIs

* TBD
* [newly deprecated] TBD Don't (yet) require semicolons on statement-like macros ([#21634][_#21634])  # The lack of semicolons after these macros is deprecated and we plan to re-enforce this requirement in a future release (after 2024-08-01). Macros that will require trailing semicolons at call sites are: DRAKE_DEFINE_CLASS_TEMPLATE_INSTANTIATIONS_ON_DEFAULT_SCALARS DRAKE_DEFINE_CLASS_TEMPLATE_INSTANTIATIONS_ON_DEFAULT_NONSYMBOLIC_SCALARS DRAKE_DECLARE_CLASS_TEMPLATE_INSTANTIATIONS_ON_DEFAULT_SCALARS DRAKE_DECLARE_CLASS_TEMPLATE_INSTANTIATIONS_ON_DEFAULT_NONSYMBOLIC_SCALARS DRAKE_DEFINE_FUNCTION_TEMPLATE_INSTANTIATIONS_ON_DEFAULT_SCALARS DRAKE_DEFINE_FUNCTION_TEMPLATE_INSTANTIATIONS_ON_DEFAULT_NONSYMBOLIC_SCALARS
* [newly deprecated fix] TBD [systems,examples,manipulation] [systems] Fix VectorSystem terrible computational performance ([#21707][_#21707])  # Output ports were performing scalar conversion during inner loops. Deprecate the defaulted direct_feedthrough constructor argument.
* [newly deprecated] TBD [multibody] Consolidate MbP geometry contact caching ([#21608][_#21608])  # There is nowhere in the plant or its helpers that only ever needs a subset of the geometry contacts. Putting all of the contact geometry into a single struct is an order of magnitude simpler.
* [newly deprecated] TBD [multibody,solvers,examples,systems,visualization] [multibody] Rename MbP output calc functions for uniformity ([#21609][_#21609])  # The output port named foo_bar is calculated via a member function named CalcFooBarOutput, with the output argument named 'output'. Always use member functions for output ports, not gratuitously long lambdas with actual logic hiding inside of them. Move the documentation about a ports' semantics from the private calc functions where nobody can find it, to the Doxygen public exposition of the ports. (In most cases it was already there, so we just remove the copy-pasted information.) Deprecate some mis-matched port names and port getter names.
* [newly deprecated] TBD [multibody] Adjust contact results targets for uniformity ([#21689][_#21689])  # The contact results and its child structs are all one logical entity, so they should be under a single build label. Also fix a related unit test to be properly split up, per its TODO. Deprecate the old bazel labels.
* [breaking change newly deprecated] TBD [multibody,lcmtypes] [multibody] ContactResults no longer reports quadrature data ([#21683][_#21683])
* [newly deprecated] TBD [multibody] Rework ContactResults for performance and safety ([#21694][_#21694])  # ContactResults is now immutable with reference counting copies, which means it is cheap to copy and even cheaper to move. It no longer has any special logic for its special member functions. (Instead, its "num_foo()" accessors need to check for a moved-from nullptr and return zero in that case.) The internal-use-only mutation functions Clear() and AddContactInfo() are removed. The internal::GeometryContactData helper is also now immutable with reference counting copies. HydroelasticContactInfo now uses shared_ptr-to-const for its surface, instead of variant-of-raw_ptr-unique_ptr. Adjust its owership-taking constructor to shared_ptr to match, and mark its dangerous bare- pointer constructor as advanced. Change its copy and move operations to be safe for raw pointers, by copying the surface instead of re-aliasing the bare pointer. This is not a performance hit for the cases we care about, because we never copy nor move anymore in the inner loops. (Only in some occasional unit tests, for which having the safe copying is actually a better trade-off.) Deprecate the existing HydroelasticContactInfo constructors. Adjust how DUM::{Calc,Eval}ContactResults assembles its answer: - First it gathers all of the relevant cache entries. This probably improves readability even today, but will pay dividends down the road when some of the entries come from state instead of cache. - This changes the helper signatures from taking a full Context to taking specific cache data instead (e.g., GeometryContactData). - Second it calls Calc functions for each contact type (point, hydro, deformable) that write into a temp vector. Previously these were Append functions that incrementally mutate the full results object. - There was also some inexplicable EvalHydroelasticContactInfo cache indirection inserted in the middle previously, which is now removed. - These helper functions now take on the responsibility of throwing for symbolics when there are non-zero number of impossible contacts. - Finally it moves those vectors into the now-immutable ContactResults struct, being careful to keep the GeometryContactData raw pointers alive. Adjust MbP::CalcContactResultsContinuous likewise. Fix MbP::CalcAndAddPointContactForcesContinuous use of a helper cache entry to only cache point pair contacts, instead of calculating unnecessary hydroelastic and deformable contact results. This covers the MbP changes that rename "contact results continuous" to "contact results point pair continuous", as well as the change to CalcContactResultsHydroelasticContinuous to zip back together the (now separately cached) surfaces and forces. Annotate MbP::EvalHydroelasticContactForcesContinuous as non-symbolic, to match its Calc twin (overlooked in a prior PR).

## Removal of deprecated items

* TBD
* [removal of deprecated] TBD [tools,workspace] Remove deprecated code 2024-07 ([#21651][_#21651])

# Notes


This release provides [pre-compiled binaries](https://github.com/RobotLocomotion/drake/releases/tag/v1.31.0) named
``drake-1.31.0-{jammy|noble|mac-arm64}.tar.gz``. See [Stable Releases](/from_binary.html#stable-releases) for instructions on how to use them.

Drake binary releases incorporate a pre-compiled version of [SNOPT](https://ccom.ucsd.edu/~optimizers/solvers/snopt/) as part of the
[Mathematical Program toolbox](https://drake.mit.edu/doxygen_cxx/group__solvers.html). Thanks to
Philip E. Gill and Elizabeth Wong for their kind support.

<!-- <begin issue links> -->
[_#21403]: https://github.com/RobotLocomotion/drake/pull/21403
[_#21500]: https://github.com/RobotLocomotion/drake/pull/21500
[_#21504]: https://github.com/RobotLocomotion/drake/pull/21504
[_#21505]: https://github.com/RobotLocomotion/drake/pull/21505
[_#21506]: https://github.com/RobotLocomotion/drake/pull/21506
[_#21520]: https://github.com/RobotLocomotion/drake/pull/21520
[_#21529]: https://github.com/RobotLocomotion/drake/pull/21529
[_#21553]: https://github.com/RobotLocomotion/drake/pull/21553
[_#21569]: https://github.com/RobotLocomotion/drake/pull/21569
[_#21579]: https://github.com/RobotLocomotion/drake/pull/21579
[_#21582]: https://github.com/RobotLocomotion/drake/pull/21582
[_#21583]: https://github.com/RobotLocomotion/drake/pull/21583
[_#21584]: https://github.com/RobotLocomotion/drake/pull/21584
[_#21587]: https://github.com/RobotLocomotion/drake/pull/21587
[_#21589]: https://github.com/RobotLocomotion/drake/pull/21589
[_#21590]: https://github.com/RobotLocomotion/drake/pull/21590
[_#21593]: https://github.com/RobotLocomotion/drake/pull/21593
[_#21607]: https://github.com/RobotLocomotion/drake/pull/21607
[_#21608]: https://github.com/RobotLocomotion/drake/pull/21608
[_#21609]: https://github.com/RobotLocomotion/drake/pull/21609
[_#21610]: https://github.com/RobotLocomotion/drake/pull/21610
[_#21611]: https://github.com/RobotLocomotion/drake/pull/21611
[_#21612]: https://github.com/RobotLocomotion/drake/pull/21612
[_#21618]: https://github.com/RobotLocomotion/drake/pull/21618
[_#21622]: https://github.com/RobotLocomotion/drake/pull/21622
[_#21629]: https://github.com/RobotLocomotion/drake/pull/21629
[_#21630]: https://github.com/RobotLocomotion/drake/pull/21630
[_#21631]: https://github.com/RobotLocomotion/drake/pull/21631
[_#21634]: https://github.com/RobotLocomotion/drake/pull/21634
[_#21641]: https://github.com/RobotLocomotion/drake/pull/21641
[_#21645]: https://github.com/RobotLocomotion/drake/pull/21645
[_#21649]: https://github.com/RobotLocomotion/drake/pull/21649
[_#21650]: https://github.com/RobotLocomotion/drake/pull/21650
[_#21651]: https://github.com/RobotLocomotion/drake/pull/21651
[_#21657]: https://github.com/RobotLocomotion/drake/pull/21657
[_#21658]: https://github.com/RobotLocomotion/drake/pull/21658
[_#21664]: https://github.com/RobotLocomotion/drake/pull/21664
[_#21665]: https://github.com/RobotLocomotion/drake/pull/21665
[_#21667]: https://github.com/RobotLocomotion/drake/pull/21667
[_#21670]: https://github.com/RobotLocomotion/drake/pull/21670
[_#21671]: https://github.com/RobotLocomotion/drake/pull/21671
[_#21674]: https://github.com/RobotLocomotion/drake/pull/21674
[_#21676]: https://github.com/RobotLocomotion/drake/pull/21676
[_#21683]: https://github.com/RobotLocomotion/drake/pull/21683
[_#21684]: https://github.com/RobotLocomotion/drake/pull/21684
[_#21685]: https://github.com/RobotLocomotion/drake/pull/21685
[_#21689]: https://github.com/RobotLocomotion/drake/pull/21689
[_#21694]: https://github.com/RobotLocomotion/drake/pull/21694
[_#21698]: https://github.com/RobotLocomotion/drake/pull/21698
[_#21702]: https://github.com/RobotLocomotion/drake/pull/21702
[_#21707]: https://github.com/RobotLocomotion/drake/pull/21707
[_#21709]: https://github.com/RobotLocomotion/drake/pull/21709
[_#21713]: https://github.com/RobotLocomotion/drake/pull/21713
<!-- <end issue links> -->

<!--
  Current oldest_commit 66be6c1eb272f5bb880134fc0e933d1269ea632b (exclusive).
  Current newest_commit be9e83171b069a5eca2d7414321dd27fa1ef0a71 (inclusive).
-->
