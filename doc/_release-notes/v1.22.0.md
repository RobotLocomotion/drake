---
title: Drake v1.22.0
date: 2099-12-31
released: YYYY-MM-DD
---

# Announcements

* Add Python 3.12 manylinux wheel support ([#20299][_#20299])
* Add pip-compatible index for installing a nightly build ([#20189][_#20189])
* TBD

# Breaking changes since v1.21.0

* TBD

Refer to our [Drake Stability Guidelines](/stable.html) for our policy
on API changes.

# Changes since v1.21.0

## Dynamical Systems

<!-- <relnotes for systems go here> -->

* [fix] TBD [controllers] Remove PidController's special Graphviz ([#20196][_#20196])  # The custom code was useful when PidController used to be a Diagram, but when it was refactored to be a LeafSystem in 53c394f8 we forgot to undo it. As we improve our default Graphviz output for systems, the custom code becomes actively harmful.
* [feature] TBD [systems,examples] [framework] Improve system graphviz output ([#20204][_#20204])  # New features: (1) Systems always show both their class name, and the user's assigned system name (if any). (2) Systems can also display extra properties if they wish, e.g., the LCM channel name URL. This is not used anywhere (yet). (3) Empty ports are greyed out. (4) Deprecated ports are struck through. (5) Users can customize the output with options specific to their code. The options are just strings, with no restrictions. (6) One built-in option is provided; "split"="I/O" can split systems in twain, which can help with left-to-right flow (e.g., with the MbP). (7) Diagram ports are consolidated into tables so that they are always sorted by port index, not allowing Graphviz to reorder them in confusing ways. (8) In the raw dot text, we number nodes using their SystemId instead of cast<int64_t>(this), to make debugging easier.  In many cases, we have plant with id 1, scene graph with id 2, etc.
* [feature] TBD [framework] Add DiagramBuilder num_{input/output}_ports accessors ([#20239][_#20239])
* [fix] TBD [systems] Don't render SharedPointerSystem in Graphviz ([#20228][_#20228])
* [breaking change feature] TBD [systems,geometry] Propagate EventStatus through the API ([#20035][_#20035])  # Breaking changes: - If user code overrides a dispatcher (e.g. DoPublish()) but also invokes the base class default implementation, execution of the default dispatch code is now deferred until the user's DoPublish() returns; previously it was executed immediately at the invocation point. - We now officially disallow user extension of class System; the only direct descendants possible are LeafSystem and Diagram. Users must derive from those classes rather than directly from System. Likely this won't affect anyone.
* [fix] TBD [sensors] RgbdSensor now passes the correct camera pose ([#20305][_#20305])  # QueryObject documents that it expected the pose of the camera *body* relative to a parent frame. RgbdSensor was passing the pose of the camera sensor relative to the parent frame. There can be a non-identity transform between the camera body and the camera sensor. The tests used the identity transform so this mistake slipped through the cracks.
* [feature] TBD [systems,manipulation] [systems/lcm] Add protocol for opting out of LCM messaging ([#20247][_#20247])  # Update IiwaDriver to implement the protocol. To take advantage of this capability, a scenario should wrap its DrakeLcmParams in Optional, e.g.: ``` # A map of {bus_name: lcm_params} for LCM transceivers to be used by # a drivers, sensors, etc. Setting the `lcm_params` to `None` # indicates that LCM should not be used for that `bus_name`. lcm_buses: typing.Mapping[str, typing.Optional[DrakeLcmParams]] = dc.field( default_factory=lambda: dict(default=DrakeLcmParams())) ```

New features

* TBD

Fixes

* TBD

## Mathematical Program

<!-- <relnotes for solvers go here> -->

* [fix] TBD HPolyhedron::FindRedundant() performance improved by using a single mathematical program ([#20188][_#20188])  # FindRedundant is used to detect the redundant hyperplanes in a HPolyedron. The current implementation is slow because at every iteration it builds a Mathematical Program object from scratch. @hongkai-dai actually had a TODO comment to fix this. This PR is an implementation of it.
* [fix] TBD Mosek license acquisition failure prints more info ([#20262][_#20262])

New features

* TBD

Fixes

* TBD

## Multibody Dynamics and Geometry

<!-- <relnotes for geometry,multibody go here> -->

* [fix] TBD Disconnected actuation input ports evaluate to zero actuation ([#20215][_#20215])  # Bug fix in MbP::AssembleActuationInput(). The vector of actuation values was not initialized to zero.
* [feature] TBD [multibody] Implements SapWeldConstraint ([#19608][_#19608])  # Implements: - MultibodyPlant::AddWeldConstraint() - MultibodyPlant::num_weld_constraint() Co-authored-by: amcastro-tri <alejandro.castro@tri.global>
* [fix] TBD [meshcat] Set Content-Type for HTML pages ([#20237][_#20237])
* [fix] TBD RenderEngineGltfClient changes how input glTFs are handled ([#20184][_#20184])  # There are two significant behavioral changes -- that *could* affect a user. However, given the newness of the underlying code and the fact that this touches distant corners of glTF-dom, the odds that anyone *actually* gets affected is small. Scene merging. Previously, all input scenes were included and scenes with the same name were merged. Now only default scenes are merged, regardless of names. Extras and extensions are properly handled. - We now include two root arrays that were previously skipped: "extensionsUsed" and "extensionsRequired". These are now merged (without duplicates). The previous omission of "extensionsUsed" and "extensionsRequired" wasn't *obviously* a defect before because some glTF parsers are more forgiving than others in terms of *applying* extensions without having declared them as "used" or "required". This simply shores up the hole to make the final glTF as compliant as the input glTFs. - When it is necessary to merge extras or extensions, if there is ambiguity, we throw an exception with enough information to help the users address the conflict in their data. If we had been previously consuming glTF files that met the error conditions, they will now start throwing. This is, however, highly unlikely.
* [fix] TBD Fix segfault in SAP when caching is disabled ([#20177][_#20177])
* [fix] TBD Removes duplicated account of actuation when using PD controllers ([#20259][_#20259])  # There are two types of force contributions: continuous forces (such as Coriolis, damping and force elements) and constraints. SAP incorporates continuous forces in the "free motion velocities" computation. Implicit PD controllers implemented in #20111 move actuation from a continuous contribution to a constraint contribution. However, #20111 failed to remove the contribution from the free motion velocities computation, and therefore this contribution is erroneously accounted for twice. This PR removes actuation from the free motion velocities computation.
* [feature] TBD [multibody,systems] Implement APIs to disable gravity at a model instance level ([#20264][_#20264])
* [fix] TBD Add DiscreteContactData ([#20209][_#20209])  # We have three types of contact: point, hydroelastic, and deformable that share similar contact data like  DiscreteContactPair and ContactPairKinematics. Currently, we store them all in a std::vector with an ordering convention that is inconsistent across various classes that produce and consume these data. We introduce DiscreteContactData to help enforce ordering conventions across the board and ensure the correct contact data is retrieved.
* [fix] TBD [geometry] Strengthen VTK to volume mesh error cases ([#20240][_#20240])  # Add some slightly more adversarial VTK files to the test suite, and improve error reporting for VTK parse failures.
* [fix] TBD Refactor MGChaoticBabyboot methods to use explicit array sizes ([#20287][_#20287])  # Addresses #20258
* [breaking change] TBD [multibody,planning] Remove $world_ prefix from automatically-added floating joint names ([#20253][_#20253])  # GetJointByName() strips the old prefix as partial compatibility support during deprecation period.
* [feature] TBD [geometry,multibody,systems,visualization] [geometry] Indicate Meshcat connections in System graphviz output ([#20270][_#20270])
* [feature] TBD RenderEngineGl supports multiple meshes from OBJ ([#20272][_#20272])  # - RenderEngineGl modified to support the multiple RenderMeshes - It introduces the same notion as Prop and Part as found in RenderEnginveVtk. - Mesh handling maps multiple possible RenderMeshes to multiple parts. - Tests updated. - Introduce the .obj equivalent of rainbox_box.gltf.
* [feature] Split MinimumDistanceConstraint. Create MinimumDistanceLowerBoundConstraint and MinimumDistanceUpperBoundConstraint. They should use different influence_distance ([#20266][_#20266])

* [fix] TBD [multibody] Implements MultibodyTreeSystem::SetDefaultParameters ([#20307][_#20307])  # Sets up a framework within MultibodyTree/MultibodyPlant to have all MultibodyElements fill in their default model parameter values upon default context creation. This change means that model default values can now change post-Finalize, and those changes will be reflected in new default contexts.
* [feature] TBD [render] RenderEngineVtk supports multiple meshes from OBJ ([#20235][_#20235])  # * RenderEngineVtk supports multiple meshes from OBJ RenderEngineVtk uses the new LoadRenderMeshesFromObj() functionality. The distinct meshes get mapped to the same prop/part infrastructure as the glTF. The description of obj support in the file format module is updated to reflect the current capability. Finally, it kills the transitory stub function introduced while transition RenderEngineGl and Vtk to multi-part OBJs.
* [feature] TBD Add SceneGraph::RemoveRenderer() ([#20319][_#20319])  # Remove a renderer from SceneGraph.

New features

* TBD

Fixes

* TBD

## Planning

<!-- <relnotes for planning go here> -->

* [fix] TBD [planning] RobotDiagramBuilder fails fast on a missing MbP or SG ([#20241][_#20241])
* [feature] TBD [planning] Export ports from RobotDiagram by default ([#20238][_#20238])

New features

* TBD

Fixes

* TBD

## Tutorials and examples

<!-- <relnotes for examples,tutorials go here> -->

* [feature] TBD [hardware_sim] Add option to output Graphviz ([#20198][_#20198])
* TBD

## Miscellaneous features and fixes

<!-- <relnotes for common,math,lcm,lcmtypes,manipulation,perception,visualization go here> -->

* [fix] TBD [kuka_iiwa] Factor non-LCM iiwa driver into a separate Diagram ([#20182][_#20182])
* [feature] TBD [math] Add hash_append to RollPitchYaw/RotationMatrix/RigidTransform ([#20252][_#20252])  # This can be useful for a part of an architecture for checking whether a pre-computed planning model for a robot or scene might have changed.
* [feature] TBD [meldis] Offer --browser selection on the command line ([#20257][_#20257])  # This is ever so slightly easier to use than the $BROWSER env var.
* TBD

## pydrake bindings

<!-- <relnotes for bindings go here> -->

New features

* ColorizeDepthImage accepts either 32F or 16U depth images ([#20254][_#20254])

Fixes

* Improve error message for solver evaluator return type mistakes ([#20178][_#20178])

## Build system

<!-- <relnotes for cmake,doc,setup,third_party,tools go here> -->

* Add Python 3.12 manylinux wheel support ([#20299][_#20299])
* Add pip-compatible index for installing a nightly build ([#20189][_#20189])
* Fail-fast in miscofigured VTK build on macOS ([#20219][_#20219])
* Patch clang.cindex for compatibility with Clang 15 ([#20261][_#20261])

## Build dependencies

<!-- <relnotes for workspace go here> -->

* Remove the ``@libcmaes`` external ([#20245][_#20245])
* Add the ``@libpng_internal`` external to build libpng from source ([#20276][_#20276])
* Add the ``@clarabel_cpp_internal`` external as an opt-in dependency ([#20246][_#20246])
  * Add supporting Rust externals (also as opt-in dependencies):
    * ``@build_bazel_apple_support``
    * ``@clarabel_cpp_internal``
    * ``@crate_universe``
    * ``@crate__amd-0.2.2``
    * ``@crate__autocfg-1.1.0``
    * ``@crate__cfg-if-1.0.0``
    * ``@crate__clarabel-0.6.0``
    * ``@crate__darling-0.14.4``
    * ``@crate__darling_core-0.14.4``
    * ``@crate__darling_macro-0.14.4``
    * ``@crate__derive_builder-0.11.2``
    * ``@crate__derive_builder_core-0.11.2``
    * ``@crate__derive_builder_macro-0.11.2``
    * ``@crate__either-1.9.0``
    * ``@crate__enum_dispatch-0.3.12``
    * ``@crate__fnv-1.0.7``
    * ``@crate__ident_case-1.0.1``
    * ``@crate__itertools-0.11.0``
    * ``@crate__lazy_static-1.4.0``
    * ``@crate__num-traits-0.2.16``
    * ``@crate__once_cell-1.18.0``
    * ``@crate__proc-macro2-1.0.67``
    * ``@crate__quote-1.0.33``
    * ``@crate__strsim-0.10.0``
    * ``@crate__syn-1.0.109``
    * ``@crate__syn-2.0.37``
    * ``@crate__thiserror-1.0.48``
    * ``@crate__thiserror-impl-1.0.48``
    * ``@crate__unicode-ident-1.0.12``
    * ``@rules_rust``
    * ``@rules_rust_tinyjson``
* Upgrade ``@curl_internal`` to latest release 8.3.0 ([#20302][_#20302])
* Upgrade ``@dm_control_internal`` to latest commit ([#20304][_#20304])
* Upgrade ``@gz_utils_internal`` to latest release 2.1.0 ([#20303][_#20303])
* Upgrade ``@rules_rust`` to latest release 0.28.0 ([#20304][_#20304])
* Upgrade ``@sdformat_internal`` to latest release 14.0.0 ([#20303][_#20303])
* Upgrade ``@suitesparse_internal`` to latest release 7.2.0 ([#20304][_#20304])
* Upgrade ``@typing_extensions_internal`` to latest 4.8.0 ([#20304][_#20304])
* Upgrade ``@yaml_cpp_internal`` to latest release 0.8.0 ([#20304][_#20304])

## Newly-deprecated APIs

* ``drake::multibody::MinimumDistanceConstraint`` ([#20282][_#20282])
  * Instead, use ``MinimumDistanceLowerBoundConstraint`` or ``MinimumDistanceUpperBoundConstraint``.
* ``drake::multibody::MinimumDistancePenaltyFunction`` ([#20282][_#20282])
  * Instead, use ``drake::solvers::MinimumValuePenaltyFunction``.
* ``drake::multibody::InverseKinematics::AddMinimumDistanceConstraint`` ([#20282][_#20282])
  * Instead, use ``AddMinimumDistanceLowerBoundConstraint``.
* ``drake::solvers::MinimumValueConstraint`` ([#20282][_#20282])
  * Instead, use ``MinimumValueLowerBoundConstraint`` or ``MinimumValueUpperBoundConstraint``.
* ``drake::systems::System::GetGraphvizFragment()`` ([#20204][_#20204])
  * Instead, override ``DoGetGraphvizFragment()``.
* ``drake::systems::System::GetGraphvizId()`` ([#20204][_#20204])
  * Instead, override ``DoGetGraphvizFragment()``.
* ``drake::systems::System::GetGraphvizInputPortToken()`` ([#20204][_#20204])
  * Instead, override ``DoGetGraphvizFragment()``.
* ``drake::systems::System::GetGraphvizOutputPortToken()`` ([#20204][_#20204])
  * Instead, override ``DoGetGraphvizFragment()``.
* The ``@libpng`` external ([#20276][_#20276])
  * The repository rule will continue to work during the deprecation window, but Drake no longer installs the Ubuntu package; if you need the package, ensure your project setup scripts install it.

## Removal of deprecated items

* `drake::geometry::optimization::CSpaceSeparatingPlane` five-argument constructor ([#19526][_#19526], [#20291][_#20291])

# Notes


This release provides [pre-compiled binaries](https://github.com/RobotLocomotion/drake/releases/tag/v1.22.0) named
``drake-YYYYMMDD-{focal|jammy|mac|mac-arm64}.tar.gz``. See [Stable Releases](/from_binary.html#stable-releases) for instructions on how to use them.

Drake binary releases incorporate a pre-compiled version of [SNOPT](https://ccom.ucsd.edu/~optimizers/solvers/snopt/) as part of the
[Mathematical Program toolbox](https://drake.mit.edu/doxygen_cxx/group__solvers.html). Thanks to
Philip E. Gill and Elizabeth Wong for their kind support.

<!-- <begin issue links> -->
[_#19526]: https://github.com/RobotLocomotion/drake/pull/19526
[_#19608]: https://github.com/RobotLocomotion/drake/pull/19608
[_#20035]: https://github.com/RobotLocomotion/drake/pull/20035
[_#20177]: https://github.com/RobotLocomotion/drake/pull/20177
[_#20178]: https://github.com/RobotLocomotion/drake/pull/20178
[_#20182]: https://github.com/RobotLocomotion/drake/pull/20182
[_#20184]: https://github.com/RobotLocomotion/drake/pull/20184
[_#20188]: https://github.com/RobotLocomotion/drake/pull/20188
[_#20189]: https://github.com/RobotLocomotion/drake/pull/20189
[_#20196]: https://github.com/RobotLocomotion/drake/pull/20196
[_#20198]: https://github.com/RobotLocomotion/drake/pull/20198
[_#20204]: https://github.com/RobotLocomotion/drake/pull/20204
[_#20209]: https://github.com/RobotLocomotion/drake/pull/20209
[_#20215]: https://github.com/RobotLocomotion/drake/pull/20215
[_#20219]: https://github.com/RobotLocomotion/drake/pull/20219
[_#20228]: https://github.com/RobotLocomotion/drake/pull/20228
[_#20235]: https://github.com/RobotLocomotion/drake/pull/20235
[_#20237]: https://github.com/RobotLocomotion/drake/pull/20237
[_#20238]: https://github.com/RobotLocomotion/drake/pull/20238
[_#20239]: https://github.com/RobotLocomotion/drake/pull/20239
[_#20240]: https://github.com/RobotLocomotion/drake/pull/20240
[_#20241]: https://github.com/RobotLocomotion/drake/pull/20241
[_#20245]: https://github.com/RobotLocomotion/drake/pull/20245
[_#20246]: https://github.com/RobotLocomotion/drake/pull/20246
[_#20247]: https://github.com/RobotLocomotion/drake/pull/20247
[_#20252]: https://github.com/RobotLocomotion/drake/pull/20252
[_#20253]: https://github.com/RobotLocomotion/drake/pull/20253
[_#20254]: https://github.com/RobotLocomotion/drake/pull/20254
[_#20257]: https://github.com/RobotLocomotion/drake/pull/20257
[_#20259]: https://github.com/RobotLocomotion/drake/pull/20259
[_#20261]: https://github.com/RobotLocomotion/drake/pull/20261
[_#20262]: https://github.com/RobotLocomotion/drake/pull/20262
[_#20264]: https://github.com/RobotLocomotion/drake/pull/20264
[_#20266]: https://github.com/RobotLocomotion/drake/pull/20266
[_#20270]: https://github.com/RobotLocomotion/drake/pull/20270
[_#20272]: https://github.com/RobotLocomotion/drake/pull/20272
[_#20276]: https://github.com/RobotLocomotion/drake/pull/20276
[_#20282]: https://github.com/RobotLocomotion/drake/pull/20282
[_#20287]: https://github.com/RobotLocomotion/drake/pull/20287
[_#20291]: https://github.com/RobotLocomotion/drake/pull/20291
[_#20299]: https://github.com/RobotLocomotion/drake/pull/20299
[_#20302]: https://github.com/RobotLocomotion/drake/pull/20302
[_#20303]: https://github.com/RobotLocomotion/drake/pull/20303
[_#20304]: https://github.com/RobotLocomotion/drake/pull/20304
[_#20305]: https://github.com/RobotLocomotion/drake/pull/20305
[_#20307]: https://github.com/RobotLocomotion/drake/pull/20307
[_#20319]: https://github.com/RobotLocomotion/drake/pull/20319
<!-- <end issue links> -->

<!--
  Current oldest_commit 877b7741f11bfa925fd16047230bc12130ae3ed6 (exclusive).
  Current newest_commit 875b7859b74afebfd64fbeb088119bc8c8ead671 (inclusive).
-->
