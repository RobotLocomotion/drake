g---
title: Drake v0.33.0
released: YYYY-MM-DD
---

# Announcements

* TBD

# Breaking changes since v0.32.0

* The ``drake/examples/pendulum/Pendulum.urdf`` now includes a weld joint ([#15426][_#15426]).
  * Users who were adding the weld by hand and should remove their weld.
* The ``drake::systems::lcm::SerializerInterface`` has a new pure-virtual method for ``Clone`` ([#15394][_#15394]).
  * Users who were extending it directly (rather than using the concrete ``Serializer`` class) should to implement the new method.

# Changes since v0.32.0

## Dynamical Systems

<!-- <relnotes for systems go here> -->

* TBD [lcm] SerializerInterface is now cloneable ([#15394][_#15394])  # Modernize "= default" boilerplate while we're here.
* TBD [analysis] Support fixed input ports in RegionOfAttraction ([#15425][_#15425])  # In response to https://stackoverflow.com/questions/68344096/is-regionofattraction-available-for-multibody-plants-from-pydrake
* TBD [systems,examples,tutorials] [examples/pendulum] Include weld joint in Pendulum.urdf ([#15426][_#15426])  # The pendulum urdf should *not* be floating by default.  This tripped me up quickly when I was testing something, and I'd like to resolve it now. This is in some sense an API-breaking change without deprecation.  I don't know how to deprecate the urdf. Code using the old workflow does get a quite clear error message: ``` RuntimeError: This MultibodyGraph already has a joint 'base_weld' connecting 'WorldBody' to 'base'. Therefore adding joint 'WorldBody_welds_to_base' connecting 'WorldBody' to 'base' is not allowed. ```
* TBD [framework] Use static_cast (not dynamic_cast) in hot paths ([#15431][_#15431])
* TBD [framework] Avoid energy-related cache updates for stateless systems ([#15432][_#15432])
* TBD [systems,examples] [systems/framework] Cease overriding DoPublish inappropriately ([#15447][_#15447])  # This replaces multiple antiquated practices regarding DoPublish(). Initially, overriding DoPublish() was the de facto mechanism for defining event handlers. As such, it appeared in many cases. Since those days, the APIs have changed and now that means is strongly discouraged. Nevertheless, the various examples were suggestive to end users who would copy this anti-pattern. This correct all erroneous overrides of DoPublish(). In some cases, where there are equally erroneous overrides of DoDiscreteValuesUpdate() or DoUnrestrictedUpdate(), in close proximity, they were corrected as well. But this doesn't generally solve the issue of those overrides. The python pattern for correcting it looks different from the C++ pattern because of the APIs available -- not all C++ sugar has been bound in python.
* TBD [framework] Deprecate dispreferred DeclareCacheEntry overloads ([#15443][_#15443])  # These overloads are not commonly necessary, so tend to clutter up the documentation and lead users to either add unnecessary boilerplate or fail to reuse context storage efficiently. In cases where these signatures were important, users can fall back to using the full set of ValueProducer constructor overloads for maximum flexibility.
* TBD [framework] Use static_cast (not dynamic_cast) in hot path ([#15470][_#15470])
* TBD Fix LQR test, use a controllable system ([#15486][_#15486])
* TBD [framework] Deprecate dispreferred DeclareOutputPort overload ([#15485][_#15485])
* TBD primitives: Introduce VectorLog ([#15484][_#15484])  # Relevant to: #10228 This is step 1 of 4 to deprecate and replace SignalLogger and SignalLog with a logging system that avoids threading hazards (SignalLogger) and slow memory management (SignalLog). VectorLog will eventually replace SignalLog. Improvements include doubling reallocation on growth (similar to std::vector), a Reserve() method to pre-allocate log space ahead of time, and adjustment of the AddData() signature to avoid unnecessary object copying and memory allocations. New unit tests demonstrate basic functionality, log storage growth, and avoidance of run-time dynamic allocations via Reserve(). History note: signal_log.* are ancestors of vector_log.*, though the contents have changed enough that git history mechanisms can't easily represent that.

New features

* TBD

Fixes

* TBD

## Mathematical Program

<!-- <relnotes for solvers go here> -->

* TBD Check if the lower/upper bounds is nan ([#15391][_#15391])  # Also check if the A matrix in linear constraint is finite.
* TBD [solvers] Add bindings for MathematicalProgram::AddCost(shared_ptr, vars) ([#15400][_#15400])  # There are a number of very similar entry points for adding costs to mathematical program.  We only binding a subset of them so far.  I elected to bind this variant because we don't currently binding the constructor for the Binding_* classes (although I've confirmed that this is also easy to do). This also follows the pattern in AddConstraint.  The AddConstraint((shared_ptr) variant was already bound, but AddConstraint(Binding<Constraint>) is not (yet). For most cases, we've avoided needing this because MathematicalProgram provides enough sugar methods to construct and add all of the variants of costs and constraints that user have been asking for.  But L2NormCost is a new case (until we outwait the deprecation period) where we cannot offer the right sugar.
* TBD MosekSolver sets logging using CommonSolverOption ([#15399][_#15399])
* TBD remove constraint from MathematicalProgram ([#15350][_#15350])
* TBD MosekSolver throws a runtime error when the solver option is not set correctly ([#15411][_#15411])  # .
* TBD Optimization program type ([#15340][_#15340])  # * Get program type of MathematicalProgram. Also add ProgramType enum class.
* TBD Support options GRBcomputeIIS and GRBwrite to gurobi solver options ([#15438][_#15438])
* TBD GurobiSolver throws errors when option is set incorrectly ([#15412][_#15412])
* TBD Replace the broken link to Lorentz and rotated Lorentz cone ([#15474][_#15474])
* TBD [solvers] De-boilerplate common solver option handling ([#15473][_#15473])
* TBD [solvers] Implement Display for ExpressionConstraint ([#15472][_#15472])  # Before Display(ExpressionConstraint) would output ``` ExpressionConstraint with 3 decision variables x0 x1 x2 ``` Now we can get beautiful output like: ``` ExpressionConstraint 0 <= (1 + pow(x0, 2)) <= 2 0 <= (x2 + pow(x1, 2)) <= 2 ```
* TBD [solvers] implement Display for Lorentz cone constraints ([#15475][_#15475])  # also touch the documentation and remove a stale detail that is no longer true.
* TBD [solver] OsqpSolver respects CommonSolverOptions::kPrintToConsole ([#15501][_#15501])
* TBD [solver] IpOptSolver respects CommonSolverOptions::kPrintToConsole ([#15502][_#15502])

New features

* TBD

Fixes

* TBD

## Multibody Dynamics and Geometry

<!-- <relnotes for geometry,multibody go here> -->

* TBD [geometry] Adds new public API for manipulating collision filters (breaking) ([#15348][_#15348])  # - Adds the CollisionFilterManager class - including python bindings - Binds the previously unbound CollisionFilterDeclaration (now that there is a public API to consume it). - Move some documentation from CollisionFilterDeclaration to CollisionFilterManager - GeometryState completely loses its legacy API (ExcludeCollisionsWithin and ExcludeCollisionBetween). This is *technically* breaking because GeometryState is erroneously in the geometry namespace. But no one actually accesses the class. It is *functionally* internal. - SceneGraph offers API access to the CollisionFilterManager - Labels the old API as "legacy". - old API expressed in terms of collision filter manager. - Documentation that referenced legacy API updated. - SceneGraphInspector
* TBD [multibody,geometry] Deprecate old collision filter API - redirect to collision_filter_manager() ([#15396][_#15396])  # The only meaningful invocation of the old API (outsdie of tests) was in MultibodyPlant. Using the new API required modifying the symbolic::Expression stub to include a stub CollisionFilterManager.
* TBD [geometry/optimization] Make Point mutable ([#15368][_#15368])  # This has proven useful in a number of unit tests.
* TBD geometry/opt: Add ConvexSet::IntersectsWith() ([#15372][_#15372])
* TBD geometry/opt: Add HPolyhedron::CartesianPower() ([#15371][_#15371])
* TBD Allow model_instances for MBP::CalcJacobianCenterOfMassTranslationalVelocity() ([#15387][_#15387])
* TBD [geometry] QueryObject's new queries for hydroelastics ([#15210][_#15210])  # Adds two new queries to QueryObject -- the tentative API to access the "polygonal" contact surface. This API is a place holder; it's return type will change. Implementing this now is merely a convenience so end users can benefit from performance improvements without waiting for the new infrastructure.
* TBD [geometry/optimization] Add GraphOfConvexSets ([#15413][_#15413])  # This first PR adds the graph construction / maintenance logic only.  I've separated the actual mathematical programming part to follow-up PRs, so that they can be reviewed more carefully. The additional correctness of the added costs/constraints on an edge will be established in the next PR, once the Solve method becomes available.
* TBD [render] Respect (renderer, accepting) for post-hoc renderers ([#15448][_#15448])  # * Respect (renderer, accepting) for post-hoc renderers When a renderer is added to SceneGraph *after* geometry was registered, the (renderer, accepting) property wasn't respected. That led, in rare cases where the property was used, that geometries would end up in the wrong render engines. This makes sure that the property is respected.
* TBD [multibody] Avoid Eigen::Block<Eigen::Ref<VectorX>> ([#15451][_#15451])  # Using a pointer to a pointer is extremely prone to use-after-free errors when the interior pointer changes through the call sequence.  Just one pointer indirection is plenty to denote what we intend.
* TBD parsing: Fix joint pose computation when using frames as joint parent or child ([#15290][_#15290])
* TBD [geometry] Add declaration to *remove* collision filters ([#15415][_#15415])  # Previous API only allowed for *adding* filters on geometry pairs. This introduces the API that can allow (generally) the removal of a filter from a geometry pair. This introduces the concept of the "permanent" filter. It supports scene graph invariants (e.g., geometries affixed to the same frame are always filtered, etc.) This concept is purely internal -- it doesn't affect the public API. The code changes include: - CollisionFilterDeclaration gets new statement methods. - CollisionFilter learns how to apply them. - CollisionFilterManager documents the "invariant" filters. - Touch numerous tests that depend on having a collision filter. - Python bindings for new API.
* TBD [geometry] Document AddPolygonToMeshDataAsOneTriangle for a polygon that is already a triangle ([#15494][_#15494])  # * [geometry] Document AddPolygonToMeshDataAsOneTriangle, which is used in hydroelastics, for the special case of the polygon that is already a triangle. Add a unit test to confirm.
* TBD [geometry] Select output format from mesh_half_space_intersection in hydroelastics ([#15358][_#15358])
* TBD [geometry/optimization] Adds IrisInConfigurationSpace ([#15476][_#15476])  # This is a first pass at the algorithm, using Snopt/Ipopt but not (yet) backed by Ibex/dReal.  That will come in the next PR. There is still an open question about whether we can use ONLY Ibex/dReal, instead of Snopt.  But based on python experiments, I believe we can use Snopt first and then follow with Ibex/dReal to confirm that our sets are collision free. Furthermore, this Snopt version is useful immediately, and including Ibex/dReal will not change the interface, only the backend.
* TBD [geometry/optimization] Adds SolveShortestPath to GraphOfConvexSets ([#15483][_#15483])  # This is the heavy lifting that I avoided including in my first PR.

New features

* TBD

Fixes

* TBD

## Tutorials and examples

<!-- <relnotes for examples,tutorials go here> -->

* TBD [examples,tutorials,manipulation] [visualization] planar visualizer uses SceneGraph API to visualize ([#15456][_#15456])  # The planar visualizer had previously used a hackneyed approach to visualize. It would generate a DrakeVisualizer lcm message for loading and consume pose bundle for updating poses. This updates it to make use of the SceneGraphInspector and QueryObject for those tasks (akin to what meshcat visualizer does). This is done in a deprecated, backwards-compatible way. The old spelling will still work, but if the visualizer is connected to a PoseBundle-valued port, the first call to draw() will dispatch a deprecation warning. This lead to the following ancillary changes: - All uses of PlanarSceneGraphVisualizer in Drake have been updated to use the new API (in fact, they've been updated to prefer using ConnectPlanarSceneGraphVisualizer). - The old unit tests have simply been copied wholesale. One test fixture is based on the new implementation, the other, labeled "Deprecated" on the old. - This also led to a change in the test for ConnectPlanar... The old test called diagram.Publish(context) on a diagram containing visualizers. However, those visualizers had their _shown flag set to False, so no drawing work was actually being done. The test has been reformulated to really test the drawing logic.
* TBD [cassie_benchmark] Allow Eigen 3.4 to use more heap operations ([#15495][_#15495])
* TBD

## Miscellaneous features and fixes

<!-- <relnotes for common,math,lcm,lcmtypes,manipulation,perception go here> -->

* TBD [math] Add DARE overload that takes Q, R, and N cost matrices ([#15352][_#15352])
* TBD [lcm] Give DrakeLcm the ability to defer launching its thread ([#15390][_#15390])  # This can be useful if the scheduling configuration for new threads varies between the construction time and and first use.
* TBD [common] Add Value::maybe_get_mutable_value ([#15418][_#15418])  # Note that we don't need to bind this in pydrake; with dynamic typing, there is no need for a "maybe" flavor of the getters.
* TBD [py trajectories] support passing matrix coefficients to ZeroOrderHold ([#15433][_#15433])  # Related to #15427
* TBD [common] Add another Eigen::numext specialization for Expression ([#15452][_#15452])  # Commit 9d4fd1a0ed02451eb50fe0775eb6f843f16e5ab3 added not_equal_strict, but we also need equal_strict for Eigen 3.4 compatibility.
* TBD [common] Fine tune {not_,}equal_strict<Expression> for Eigen 3.4 ([#15453][_#15453])  # In various Eigen algorithms, it uses "short-circuit when zero" guards to skip computationally expensive steps in cases where knows the end result will remain unchanged. When we have Expressions filled with only constants, this works fine. However, when we have Expressions filled with Variables, trying to check for zero throws an exception because the resulting Formula cannot convert to back to a bool -- and in any case, we want the full expression tree anyway, without any short-circuits, for doing symbolic evaluation later. Therefore, we tweak Eigen::numext::equal_strict and not_equal_strict to special-case their results if either of the operands is a literal zero, with no throwing even if the other operand has unbound variables.
* TBD [common] Remove copy/move from ExpressionCell ([#15466][_#15466])  # We do not appear to take advantage of the copy / move construction at all (and we have const members, so I suspect move was doing copies anyway). For optimizations like opportunistic mutation or more careful sharing, it seems like having implicit copies available might be a bit of a hazard. Similarly, the base class default destructor is dead code, so is removed. Fix a stray comment on a factory default constructor.
* TBD [py/trajectories] bind matrix versions of PiecewisePolynomial ([#15442][_#15442])  # Takes the pattern established in #15433, and implements it for the remaining construction methods. Resolves #15427.
* TBD [trajectories] Fix uninitialized data in unit test ([#15499][_#15499])  # Caught by memcheck when running against Eigen 3.4
* TBD

## pydrake bindings

<!-- <relnotes for bindings go here> -->

* TBD [pydrake] Add bindings for TrajectoryLinearSystem ([#15397][_#15397])
* TBD py mp: Allow upcasting to Binding<Constraint> ([#15408][_#15408])
* TBD py mp: Reorder overall bindings for better Python type signatures ([#15410][_#15410])  # Otherwise, type signatures may have C++ types
* TBD pydrake: Add binding for PackageMap.Remove ([#15430][_#15430])  # Co-authored-by: Scott K Logan <logans@cottsay.net> Co-authored-by: Ian McMahon <ian.mcmahon@tri.global>
* TBD py mp: Use template Binding[{Type}]; deprecate old Binding_{Type} ([#15409][_#15409])  # pydrake/__init__.py: - Do not repeat leading `_` for ExecuteExtraPythonCode - Allow forwarding of private `_` variables from cc modules deprecation: - Fix (Py 2 -> Py 3) for empty AttributeError messages - Add ModuleShim._install(*, auto_all)
* TBD py mp: Fix docstring spelling for forwarded module ([#15457][_#15457])

New features

* TBD

Fixes

* TBD

Newly bound

* TBD

## Build system

<!-- <relnotes for cmake,doc,setup,third_party,tools go here> -->

* TBD [tools,multibody] [drake_visualizer] Label spatial force on object in for hydro contact ([#15416][_#15416])  # For visualizing hydroelastic contact, the visualized quantities would label a pair of geometries and show various quantities. One was labeled simply "Spatial force" but didn't indicate which body in the pair the force was acting on. This adds the name of the body being acted on. For point-pair contact, we also label which body the force is applied to. There's some additional complexity for point pair contact due to the fact that there are no guarantees on body ordering. This also adds notes on that specific subject (and a TODO in MBP to address this).
* TBD [tools] Deprecate expose_all_files and remove external_data stubs ([#15469][_#15469])  # This project is no longer active, and yet is adding complexity to our top-level WORKSPACE.
* TBD

## Build dependencies

<!-- Manually relocate any "Upgrade foo_external to latest" lines to here, -->
<!-- and then sort them alphabetically. -->

* TBD

## Newly-deprecated APIs

* TBD

## Removal of deprecated items

* TBD

# Notes


This release provides [pre-compiled binaries](https://github.com/RobotLocomotion/drake/releases/tag/v0.33.0) named
``drake-YYYYMMDD-{bionic|focal|mac}.tar.gz``. See [Nightly Releases](/from_binary.html#nightly-releases) for instructions on how to use them.

Drake binary releases incorporate a pre-compiled version of [SNOPT](https://ccom.ucsd.edu/~optimizers/solvers/snopt/) as part of the
[Mathematical Program toolbox](https://drake.mit.edu/doxygen_cxx/group__solvers.html). Thanks to
Philip E. Gill and Elizabeth Wong for their kind support.

<!-- <begin issue links> -->
[_#15210]: https://github.com/RobotLocomotion/drake/pull/15210
[_#15290]: https://github.com/RobotLocomotion/drake/pull/15290
[_#15340]: https://github.com/RobotLocomotion/drake/pull/15340
[_#15348]: https://github.com/RobotLocomotion/drake/pull/15348
[_#15350]: https://github.com/RobotLocomotion/drake/pull/15350
[_#15352]: https://github.com/RobotLocomotion/drake/pull/15352
[_#15358]: https://github.com/RobotLocomotion/drake/pull/15358
[_#15368]: https://github.com/RobotLocomotion/drake/pull/15368
[_#15371]: https://github.com/RobotLocomotion/drake/pull/15371
[_#15372]: https://github.com/RobotLocomotion/drake/pull/15372
[_#15387]: https://github.com/RobotLocomotion/drake/pull/15387
[_#15390]: https://github.com/RobotLocomotion/drake/pull/15390
[_#15391]: https://github.com/RobotLocomotion/drake/pull/15391
[_#15394]: https://github.com/RobotLocomotion/drake/pull/15394
[_#15396]: https://github.com/RobotLocomotion/drake/pull/15396
[_#15397]: https://github.com/RobotLocomotion/drake/pull/15397
[_#15399]: https://github.com/RobotLocomotion/drake/pull/15399
[_#15400]: https://github.com/RobotLocomotion/drake/pull/15400
[_#15408]: https://github.com/RobotLocomotion/drake/pull/15408
[_#15409]: https://github.com/RobotLocomotion/drake/pull/15409
[_#15410]: https://github.com/RobotLocomotion/drake/pull/15410
[_#15411]: https://github.com/RobotLocomotion/drake/pull/15411
[_#15412]: https://github.com/RobotLocomotion/drake/pull/15412
[_#15413]: https://github.com/RobotLocomotion/drake/pull/15413
[_#15415]: https://github.com/RobotLocomotion/drake/pull/15415
[_#15416]: https://github.com/RobotLocomotion/drake/pull/15416
[_#15418]: https://github.com/RobotLocomotion/drake/pull/15418
[_#15425]: https://github.com/RobotLocomotion/drake/pull/15425
[_#15426]: https://github.com/RobotLocomotion/drake/pull/15426
[_#15430]: https://github.com/RobotLocomotion/drake/pull/15430
[_#15431]: https://github.com/RobotLocomotion/drake/pull/15431
[_#15432]: https://github.com/RobotLocomotion/drake/pull/15432
[_#15433]: https://github.com/RobotLocomotion/drake/pull/15433
[_#15438]: https://github.com/RobotLocomotion/drake/pull/15438
[_#15442]: https://github.com/RobotLocomotion/drake/pull/15442
[_#15443]: https://github.com/RobotLocomotion/drake/pull/15443
[_#15447]: https://github.com/RobotLocomotion/drake/pull/15447
[_#15448]: https://github.com/RobotLocomotion/drake/pull/15448
[_#15451]: https://github.com/RobotLocomotion/drake/pull/15451
[_#15452]: https://github.com/RobotLocomotion/drake/pull/15452
[_#15453]: https://github.com/RobotLocomotion/drake/pull/15453
[_#15456]: https://github.com/RobotLocomotion/drake/pull/15456
[_#15457]: https://github.com/RobotLocomotion/drake/pull/15457
[_#15466]: https://github.com/RobotLocomotion/drake/pull/15466
[_#15469]: https://github.com/RobotLocomotion/drake/pull/15469
[_#15470]: https://github.com/RobotLocomotion/drake/pull/15470
[_#15472]: https://github.com/RobotLocomotion/drake/pull/15472
[_#15473]: https://github.com/RobotLocomotion/drake/pull/15473
[_#15474]: https://github.com/RobotLocomotion/drake/pull/15474
[_#15475]: https://github.com/RobotLocomotion/drake/pull/15475
[_#15476]: https://github.com/RobotLocomotion/drake/pull/15476
[_#15483]: https://github.com/RobotLocomotion/drake/pull/15483
[_#15484]: https://github.com/RobotLocomotion/drake/pull/15484
[_#15485]: https://github.com/RobotLocomotion/drake/pull/15485
[_#15486]: https://github.com/RobotLocomotion/drake/pull/15486
[_#15494]: https://github.com/RobotLocomotion/drake/pull/15494
[_#15495]: https://github.com/RobotLocomotion/drake/pull/15495
[_#15499]: https://github.com/RobotLocomotion/drake/pull/15499
[_#15501]: https://github.com/RobotLocomotion/drake/pull/15501
[_#15502]: https://github.com/RobotLocomotion/drake/pull/15502
<!-- <end issue links> -->

<!--
  Current oldest_commit 37832588e9e65a84d6eea121159d469309c32f2e (exclusive).
  Current newest_commit cec5e3e5da24d0d232b550664943d57a02c33c07 (inclusive).
-->
