---
title: Drake v0.34.0
released: YYYY-MM-DD
---

# Announcements

* TBD

# Breaking changes since v0.33.0

* TBD

# Changes since v0.33.0

## Dynamical Systems

<!-- <relnotes for systems go here> -->

* TBD Make simulator config functions autodiffable ([#15584][_#15584])
* TBD [systems,examples,tutorials] primitives: deprecate SignalLogger and friends ([#15594][_#15594])  # Closes: #10228 This is step 4 of 4 to deprecate and replace SignalLogger and SignalLog with a logging system that avoids threading hazards (SignalLogger) and slow memory management (SignalLog). The patch deprecates SignalLog, SignalLogger, and LogOutput, and replaces them within Drake by VectorLog, VectorLogSink and LogVectorOutput, respectively.
* TBD Switch to per-context dummy CacheEntryValue for thread safety ([#15564][_#15564])  # Previously we used a singleton "dummy" CacheEntryValue as a /dev/null-like destination for throw-away writes. This caused trouble with Tsan in multithreaded PR #15537. This commit switches to using a per-Context dummy rather than a singleton. This is mildly tricky due to the need to switch dummy destinations during Context cloning.
* TBD Perform MonteCarloSimulation in parallel ([#15537][_#15537])
* TBD Allow multiple LcmInterfaceSystems on the same URL ([#15653][_#15653])
* TBD [framework] Fix deprecated AddIfSupported scalar conversion helper ([#15657][_#15657])  # The prior implementation of this template function contained broken code, but was never compiled so we never noticed.
* TBD [systems,solvers] Remove deprecated code 2021-09 ([#15701][_#15701])
* TBD [primitives] Promote RandomSource to be templated on scalar ([#15708][_#15708])

New features

* TBD

Fixes

* TBD

## Mathematical Program

<!-- <relnotes for solvers go here> -->

* TBD [solvers] IbexSolver supports more constraints / costs ([#15607][_#15607])
* TBD [solvers] Fix program type for NLP with linear complementary constraints ([#15625][_#15625])
* TBD [solvers] Simplify DoCheckSatisfied for equality constraints ([#15612][_#15612])  # For lb <= y <= ub, we simplify it to lb == y when lb == ub.
* TBD [solvers] Support IBEX Solver options ([#15612][_#15612])
* TBD [solvers,geometry] Choose best solver based on program type ([#15541][_#15541])

New features

* TBD

Fixes

* TBD

## Multibody Dynamics and Geometry

<!-- <relnotes for geometry,multibody go here> -->

* TBD Replace an expensive dynamic_cast with a cheap static_cast ([#15489][_#15489])  # * Replace dynamic_cast with static_cast for MbP state access.
* TBD [geometry] Moves DrakeVisualizerParams into dedicated header ([#15599][_#15599])  # This allows downstream code to make decisions about parameters without dragging all of SceneGraph into their headers.
* TBD geometry/opt: Add Edge::AddPhiConstraint() ([#15572][_#15572])  # This allows the user to constrain the binary variable associated with an Edge in a GraphOfConvexSets.
* TBD Adding collision filter groups sdf support ([#15477][_#15477])  # This refactors the functionality for parsing collision filter groups. Pulled out of the urdf parsing details, it now lives in detail_common.h and is refactored to handle both URDF and SDF parse infrastructure.
* TBD [geometry,tools,setup,doc] [geometry] Establishes Meshcat in C++ (step 1) ([#15618][_#15618])  # This is the first of a series of PRs that will provide Meshcat as a visualizer in C++.  The design and PR strategy is documented in #13038. This is the first PR: Meshcat proof of life. Starts the server, demonstrates that clients can connect, and just sends one type of message to show that data can flow. Reviewers can focus on the build system and websocket server details. The dependencies added here are all quite lightweight, and properly licensed.  And at the end of the PR train, we will likely want to deprecate meshcat-python, and eventually remove the pip dependencies that come along with it.
* TBD [multibody] Fix error in ContactResultsToLcmSystem ([#15610][_#15610])  # The original implementation of ContactResultsToLcmSystem had a public scalar-converting copy constructor and a unit test called "Transmogrify". It clearly had the intention to be transmogrifiable. However, the copy constructor was broken -- an instance constructed via that copy constructor would have empty tables and no ports. It also wasn't properly transmogrifiable in the system scalar conversion sense. Finally, the unit test was insufficient to show these issues and invalid in its spelling. More generally, the organization of the unit tests were haphazard, rendering extension of those unit tests (in subsequent PRs) largely intractible. This PR provides the full infrastructure to realize the implied intent of being transmogrifiable.  The unit tests have been completely revisited to provide greater coverage with special attention paid to transmogrified systems and documenting the testing philosophy and strategy.
* TBD [geometry,setup,tools] [geometry] Establishes Meshcat in C++ (step 2) ([#15626][_#15626])  # Adds test coverage, and therefore moves Meshcat out of dev. Per discussion with jwnimmer-tri, the strategy here is to provide a reasonable coverage of the c++ code (CI runs most all of the code and verifies it doesn't segfault). I explored more elaborate testing mechanisms (documented in #13038) using nodejs.  This could add value downstream, but adding nodejs support to bazel might be a big upfront (and even maintenance) cost for relatively small gain.  As jwnimmer-tri points out, we don't provide that level of coverage for DrakeVisualizer.
* TBD Introduce "transient" filter modifications ([#15492][_#15492])  # This introduces the concept of a history of collision filter modifications and the ability to edit that history. - Introduce new id type: FilterId. - CollisionFilterManager introduces the concept and provides an API for exercising it. - CollisionFilter implements the plumbing. - Python bindings
* TBD [multibody,geometry] MBP SetPositions(.), SetVelocities(.) etc. take an Eigen::Ref rather than a VectorX ([#15561][_#15561])  # Towards #13735 This PR introduces a breaking change to the API that is unlikely to impact most users.  SetPositions(...), SetVelocities(...), and SetPositionsAndVelocities(...) methods which used to accept a VectorX<Variable> must now have their arguments explicitly cast to VectorX<Expression> (e.g. with x.cast<symbolic::Expression>()).  See #15560 for some discussion. LimitMalloc tests were authored by rpoyner-tri
* TBD multibody: Properly validate State at public APIs ([#15646][_#15646])  # Closes: #11252
* TBD [multibody,examples] [multibody] Add new enumerator names for ContactModel ([#15656][_#15656])  # Retain the old names for now, to avoid immediately disrupting existing users; eventually, we should deprecated the legacy names.
* TBD [multibody,tools] Add and register top-level Drake package.xml ([#15468][_#15468])  # This change (re-)adds a top-level package manifest for Drake, and registers it in all PackageMap instances during construction. This should enable URI resolution that currently utilizes individual package manifests within the Drake source tree to switch to the new top-level manifest with relatively little effort. Note that the new package manifest conforms with the appropriate schema, but contains no dependency information and has a placeholder version number (0.0.0) in place of the actual Drake version. These are not necessary to use the manifest for resolving URIs. Co-authored-by: Scott K Logan <logans@cottsay.net> Co-authored-by: Ian McMahon <ian.mcmahon@tri.global> Co-authored-by: Jeremy Nimmer <jeremy.nimmer@tri.global>
* TBD [geometry,tools] [geometry] Establish Meshcat in C++ (step 3) ([#15647][_#15647])  # Implements the most essential elements of the Meshcat API: - Added SceneTree data structure. - Added stduuid (to create the uuid's required by meshcat) - Added SetObject from Shape, Rgba - Supports all shapes that meshcat_visualizer.py supports (more, in fact) - Does not support texture maps yet. - Added SetTransform - Added Delete - Added SetProperty<double> - Added HasPath, GetPacked* methods, primarily for testing. This PR is > 500 lines, but a significant portion of this commit is relatively boilerplate management of the msgpack data structures used to communicate with the javascript client. Updated the meshcat_manual_test to step the user through the checks. Updated meschat_test to hammer on the new API.
* TBD detail_sdf_parser: Add 2021-12-01 removal date for unrecognized elements ([#15672][_#15672])
* TBD [geometry] Establish Meshcat in C++ (step 4) ([#15670][_#15670])  # Adds MeshcatVisualizer Resolves #13038
* TBD [geometry,tools,doc] [geometry] Install meshcat data files ([#15679][_#15679])  # Without this, Meshcat worked fine in the source tree, but was unable to locate its resources in the installation directory.
* TBD [geometry] Add python bindings for Meshcat/MeshcatVisualizerCpp ([#15683][_#15683])  # Follow-up to #13038. Also makes the meshcat_visualizer_test.py more robust (test_warnings_and_errors could fail if the default zmq_url was already consumed)
* TBD Add HPolyhedron::CartesianProduct ([#15608][_#15608])
* TBD Fixes BodyNode::GetJacobianFromArray() to return an empty map when nv=0 ([#15686][_#15686])  # * Fixes GetJacobianFromArray() to return an empty map when nv=0.
* TBD [multibody,lcmtypes] Modify hydro contact vis to provide more information (names) ([#15642][_#15642])  # tl;dr We *now* include geometry and model instance names with the previously broadcast body names in the hydroelastic contact visualization lcm message. This fixes *two* bugs in hydroelastic visualization contact: 1. Information provided in LCM was insufficient to distinguish contact between two identically named bodies which belong to different model instances. - Solution: - Extend the lcm message to include model instance names. - ContactData -> LCM message populates model instance names. 2. Multiple independent contacts between the *same* bodies aren't handled correctly. - Solution: - Also provide a "name" for the *geometry*. - Legacy constructor for ContactResultToLcmSystem takes only a MBP instance. As such, it can't resolve collision geometry *names*. - Constructed with the old API, we use stringified geometry ids. - The ConnectContactResultsToDrakeVisualizer methods have been overloaded to also accept a SceneGraph instance. When given, the geometry names will be acquired from that instance. - Add bindings for new API. This does *not* include changes to the visualizer itself. The data produced here is a strict superset of the old data. The visualizer will be updated in a follow-up PR.
* TBD [geometry,tools,setup] [geometry:meshcat] Upgrade meshcat and meshcat-python versions ([#15684][_#15684])  # meshcat changes the scaling of the background color meshcat updated three.js, which required some non-trivial changes to my msgpack usage.
* TBD [geometry] Binding proximity_properties.h ([#15689][_#15689])  # A number of useful utility functions for setting proximity properties had been omitted from binding. This adds them.
* TBD multibody: Add joint locking ([#15644][_#15644])  # Closes: #14200 Adapted from original implementation by Joe Masterjohn joe.masterjohn@tri.global. See also his draft #15137. Thanks also to Joe for serving as co-author and advisor on this patch. This patch builds on Joe's implementation, mostly by expanding documentation and tests.
* TBD multibody plant: Fix TAMSI threading hazard ([#15690][_#15690])  # Closes: #15674 The storage of the TamsiSolver as member data created a thread-race hazard for context-per-thread usage. Instead, store the solver (via shared_ptr) in a scratch cache entry. Reorganize transmission of stiction_tolerance to be maximally lazy, in part to avoid the absence of context access where it used to be transmitted. The patch also adds some minimal test coverage for context-per-thread usage in both discrete and continuous modes.
* TBD [geometry,tools,doc] [geometry] Fix installation paths for meshcat ([#15732][_#15732])

New features

* TBD

Fixes

* TBD

## Tutorials and examples

<!-- <relnotes for examples,tutorials go here> -->

* TBD

## Miscellaneous features and fixes

<!-- <relnotes for common,math,lcm,lcmtypes,manipulation,perception go here> -->

* TBD [common] Deprecate DRAKE_ASSERT on a bare pointer ([#15597][_#15597])  # For a raw pointer (e.g., 'foo' in 'void DoStuff(Foo* foo);'), when checking for null we'd like to insist on an explicit mention of nullptr: Correct: DRAKE_ASSERT(foo != nullptr); Correct: DRAKE_DEMAND(foo != nullptr); Incorrect: DRAKE_ASSERT(foo); Incorrect: DRAKE_DEMAND(foo); Because the macro sometimes results in error messages seen by users, we should err on the side of extra detail about the failure condition.  The meaning of "foo" isolated within error message text does not make it clear that a null pointer is the proximate cause of the problem.
* TBD [lcm,systems] [lcm] Add SubscribeAllChannels and get_lcm_url ([#15575][_#15575])  # * Fixes #15569 * This provides mechanisms that downstream projects have gotten by directly accessing the native LCM rather than via the interface: * This captures the use of a `.*` regex on the native lcm, which was being abused downstream, behind a proper function. * No support of more general regexps at this time, but the API change to support that is pretty clear so we can come back to that in the future. * Provides a URL-like string for logging
* TBD [manipulation/models] Fix warnings generated by sdf parsing of ycb objects ([#15648][_#15648])  # Each of the ycb sdf tags had irrelevant material elements inside collision elements.  The updated sdf parser (correctly) spews sdplog warnings about them, so I have removed them.
* TBD Deprecate two unused autodiff utility functions ([#15658][_#15658])  # .
* TBD Deprecate the Transform specializations of Discard[Zero]Gradient() ([#15697][_#15697])  # .
* TBD [common] Always allow caller clean up directory from temp_directory() ([#15698][_#15698])  # * Modify temp_directory so the caller can always clean up. For code that creates a temporary working directory, this cleans up the ambiguity of whether or not it is able to delete that directory. Now it can *always* clean up (modulo catastrophic system failures). Updates the tests that confirm the behavior when TEST_TMPDIR is set.
* TBD

## pydrake bindings

<!-- <relnotes for bindings go here> -->

* TBD py value: Register Value[float] for use with ProximityProperties ([#15641][_#15641])  # Issue 15640 showed that when a float was placed into a ProximityProperties in python, C++ code attempting to extract double failed -- it found a type-erased python object. This extends the values bindings to include the double typed stashed in a Value and adapts the tests accordingly to confirm that the value can be extracted in C++. This introduces a unique C++ function, bound in pydrake.geometry.testing to facilitate the testing.
* TBD py math: Add patch for rich comparison operators; test combinatorics ([#15659][_#15659])  # Tests both symbolic types and AutoDiffXd numpy_compare: Add soft_sub_test workaround deprecation: Catch old-style deprecation elementwise != comparison Co-Authored-By: Jeremy Nimmer <jeremy.nimmer@tri.global>
* TBD Enable copy/deepcopy for SpatialInertia ([#15676][_#15676])
* TBD Add Python bindings for mixed integer rotation constraint generator ([#15678][_#15678])  # * Bindings for IntervalBinning and MixedIntegerRotationConstraintGenerator. - Add tests for MI rotation constraint builder.
* TBD Add rotation constraint python bindings to solvers.all ([#15687][_#15687])
* TBD Fix bug in meshcat contact force visualization ([#15677][_#15677])  # In order to pose the contact vector, we needed to define the pose of the contact *frame* in the world The technique used was insufficient. Now the frame is robustly computed and the contact vectors are properly aligned.
* TBD Enabling pickling for Inertia types, CoulombFriction, and most Shapes ([#15715][_#15715])
* TBD Python binding for CalcJacobianCenterOfMassTranslationalVelocity() with model_instances ([#15691][_#15691])  # * Python binding for CalcJacobianCenterOfMassTranslationalVelocity() with parameter model_instances.

New features

* TBD

Fixes

* TBD

Newly bound

* TBD

## Build system

<!-- <relnotes for cmake,doc,setup,third_party,tools go here> -->

* TBD [tools,common,manipulation,multibody] Deprecate various unused bits of code ([#15639][_#15639])  # * The eigen_stl_types.h header. * The schunk_buttons.py helper script. * The @jsoncpp external.
* TBD [tools] Link ignition-math statically ([#15600][_#15600])  # It was an oddball in terms of being a shared library. Deprecate the installed shared library.
* TBD [tools,solvers] [solvers] Update IBEX and remove no_memcheck tag in ibex_solver_test ([#15671][_#15671])
* TBD [tools,setup] Install msgpack-cxx on Mac ([#15694][_#15694])  # A recent update in msgpack's homebrew required us to declare our dependency differently. - Replace msgpack with msgpack-cxx. - msgpack-cxx doesn't have a package config file. We handle the linux and mac declarations differently.
* TBD [workspace] Upgrade tinyobjloader to latest commit v2.0.0-rc9 ([#15714][_#15714])
* TBD [workspace] Upgrade uwebsockets to latest release v19.4.0 ([#15719][_#15719])
* TBD [doc,setup,tools] [setup] Upgrade bazel to latest release 4.2.1 ([#15711][_#15711])  # Set our minimum supported bazel version to >= 4.0.  We have not been compatible with the bazel 3.x series since we upgraded rules_python on July 1st and rules_pkg on August 2nd.
* TBD [workspace] Upgrade CRU and VGT to latest commit ([#15716][_#15716])  # Upgrade common_robotics_utilities to latest commit. Upgrade voxelized_geometry_tools to latest commit.
* TBD [workspace] Upgrade intel_realsense_ros to latest release 2.3.1 ([#15723][_#15723])
* TBD [workspace] Upgrade rules_pkg to latest release 0.5.1 ([#15725][_#15725])
* TBD [workspace] Upgrade lcm to latest commit ([#15717][_#15717])  # Note that this upgrade contains a fix to mutex locking, so might warrant additional caution when monitoring for regressions after the upgrade.
* TBD [workspace] Upgrade ros_xacro to latest release 1.13.12 ([#15724][_#15724])
* TBD [workspace] Upgrade googlebenchmark to latest release 1.5.6 ([#15718][_#15718])
* TBD

## Build dependencies

<!-- Manually relocate any "Upgrade foo_external to latest" lines to here, -->
<!-- and then sort them alphabetically. -->

* TBD

## Newly-deprecated APIs

* TBD

## Removal of deprecated items

* TBD

# Notes


This release provides [pre-compiled binaries](https://github.com/RobotLocomotion/drake/releases/tag/v0.34.0) named
``drake-YYYYMMDD-{bionic|focal|mac}.tar.gz``. See [Nightly Releases](/from_binary.html#nightly-releases) for instructions on how to use them.

Drake binary releases incorporate a pre-compiled version of [SNOPT](https://ccom.ucsd.edu/~optimizers/solvers/snopt/) as part of the
[Mathematical Program toolbox](https://drake.mit.edu/doxygen_cxx/group__solvers.html). Thanks to
Philip E. Gill and Elizabeth Wong for their kind support.

<!-- <begin issue links> -->
[_#15468]: https://github.com/RobotLocomotion/drake/pull/15468
[_#15477]: https://github.com/RobotLocomotion/drake/pull/15477
[_#15489]: https://github.com/RobotLocomotion/drake/pull/15489
[_#15492]: https://github.com/RobotLocomotion/drake/pull/15492
[_#15537]: https://github.com/RobotLocomotion/drake/pull/15537
[_#15541]: https://github.com/RobotLocomotion/drake/pull/15541
[_#15561]: https://github.com/RobotLocomotion/drake/pull/15561
[_#15564]: https://github.com/RobotLocomotion/drake/pull/15564
[_#15572]: https://github.com/RobotLocomotion/drake/pull/15572
[_#15575]: https://github.com/RobotLocomotion/drake/pull/15575
[_#15584]: https://github.com/RobotLocomotion/drake/pull/15584
[_#15594]: https://github.com/RobotLocomotion/drake/pull/15594
[_#15597]: https://github.com/RobotLocomotion/drake/pull/15597
[_#15599]: https://github.com/RobotLocomotion/drake/pull/15599
[_#15600]: https://github.com/RobotLocomotion/drake/pull/15600
[_#15607]: https://github.com/RobotLocomotion/drake/pull/15607
[_#15608]: https://github.com/RobotLocomotion/drake/pull/15608
[_#15610]: https://github.com/RobotLocomotion/drake/pull/15610
[_#15612]: https://github.com/RobotLocomotion/drake/pull/15612
[_#15618]: https://github.com/RobotLocomotion/drake/pull/15618
[_#15625]: https://github.com/RobotLocomotion/drake/pull/15625
[_#15626]: https://github.com/RobotLocomotion/drake/pull/15626
[_#15639]: https://github.com/RobotLocomotion/drake/pull/15639
[_#15641]: https://github.com/RobotLocomotion/drake/pull/15641
[_#15642]: https://github.com/RobotLocomotion/drake/pull/15642
[_#15644]: https://github.com/RobotLocomotion/drake/pull/15644
[_#15646]: https://github.com/RobotLocomotion/drake/pull/15646
[_#15647]: https://github.com/RobotLocomotion/drake/pull/15647
[_#15648]: https://github.com/RobotLocomotion/drake/pull/15648
[_#15653]: https://github.com/RobotLocomotion/drake/pull/15653
[_#15656]: https://github.com/RobotLocomotion/drake/pull/15656
[_#15657]: https://github.com/RobotLocomotion/drake/pull/15657
[_#15658]: https://github.com/RobotLocomotion/drake/pull/15658
[_#15659]: https://github.com/RobotLocomotion/drake/pull/15659
[_#15670]: https://github.com/RobotLocomotion/drake/pull/15670
[_#15671]: https://github.com/RobotLocomotion/drake/pull/15671
[_#15672]: https://github.com/RobotLocomotion/drake/pull/15672
[_#15676]: https://github.com/RobotLocomotion/drake/pull/15676
[_#15677]: https://github.com/RobotLocomotion/drake/pull/15677
[_#15678]: https://github.com/RobotLocomotion/drake/pull/15678
[_#15679]: https://github.com/RobotLocomotion/drake/pull/15679
[_#15683]: https://github.com/RobotLocomotion/drake/pull/15683
[_#15684]: https://github.com/RobotLocomotion/drake/pull/15684
[_#15686]: https://github.com/RobotLocomotion/drake/pull/15686
[_#15687]: https://github.com/RobotLocomotion/drake/pull/15687
[_#15689]: https://github.com/RobotLocomotion/drake/pull/15689
[_#15690]: https://github.com/RobotLocomotion/drake/pull/15690
[_#15691]: https://github.com/RobotLocomotion/drake/pull/15691
[_#15694]: https://github.com/RobotLocomotion/drake/pull/15694
[_#15697]: https://github.com/RobotLocomotion/drake/pull/15697
[_#15698]: https://github.com/RobotLocomotion/drake/pull/15698
[_#15701]: https://github.com/RobotLocomotion/drake/pull/15701
[_#15708]: https://github.com/RobotLocomotion/drake/pull/15708
[_#15711]: https://github.com/RobotLocomotion/drake/pull/15711
[_#15714]: https://github.com/RobotLocomotion/drake/pull/15714
[_#15715]: https://github.com/RobotLocomotion/drake/pull/15715
[_#15716]: https://github.com/RobotLocomotion/drake/pull/15716
[_#15717]: https://github.com/RobotLocomotion/drake/pull/15717
[_#15718]: https://github.com/RobotLocomotion/drake/pull/15718
[_#15719]: https://github.com/RobotLocomotion/drake/pull/15719
[_#15723]: https://github.com/RobotLocomotion/drake/pull/15723
[_#15724]: https://github.com/RobotLocomotion/drake/pull/15724
[_#15725]: https://github.com/RobotLocomotion/drake/pull/15725
[_#15732]: https://github.com/RobotLocomotion/drake/pull/15732
<!-- <end issue links> -->

<!--
  Current oldest_commit 92be0bd4a6c50cdd0edb1963323ccbd178c0f608 (exclusive).
  Current newest_commit 0f7d591799d6f5c3c0953147d0c3460355378f3a (inclusive).
-->
