function df = compassGaitGrads(r,t,x,u,order)

% This file evaluates the gradients of the robot dynamics.
% Usage:  df = compassGaitGrads(r,t,x,u,order)
%   r 		- CompassGaitStancePlant class object
%   t 		- time (scalar)
%   x 		- 4-by-1 state vector
%   u 		- 1-by-1 input vector
%   order 	- order of gradients to compute (1<=order<=3)
% This is an auto-generated file.  See <a href="matlab: help robot>generate_dynamics_func_gradients">robot>generate_dynamics_func_gradients</a>. 

% NOTEST

% Check inputs:
if (~isa(r,'CompassGaitStancePlant')) error(' r must be a CompassGaitStancePlant class object'); end
if (length(t)~=1) error('t must be a scalar'); end
if (any(size(x)~=[4,1])) error('x must be a 4-by-1 vector'); end
if (any(size(u)~=[1,1])) error('u must be a 1-by-1 vector'); end
if ((order<1) || (order>3)) error('1<=order<=3'); end

% Symbol table:
m=r.m; mh=r.mh; a=r.a; b=r.b; l=r.l; g=r.g; num_q=r.num_q; umin=r.umin; umax=r.umax; 
x1=x(1);x2=x(2);x3=x(3);x4=x(4);
u1=u(1);

% df{1}
fa = sparse(4,6);
fa(1,4) = 1;
fa(2,5) = 1;
fa(3,2) = (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(3,3) = (b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(3,4) = -(l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(3,5) = (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(3,6) = -(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(4,2) = (- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,3) = (b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2))/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,4) = -(2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,5) = (l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,6) = (2*b - 2*l*cos(x1 - x2))/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
df{1} = fa;


if (order>=3)
% df{2}{1}
fa = sparse(4,6);
df{2}{1} = fa;

% df{2}{2}
fa = sparse(4,6);
fa(3,2) = (2*l^2*cos(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) - a^2*b*g*m^2*sin(x1) - b*g*l^2*m^2*sin(x1) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) - b*g*l^2*m*mh*sin(x1) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*sin(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*sin(x1 - x2)*cos(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,4) = (2*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*x3*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(3,5) = (2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(3,6) = (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*sin(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(4,2) = (2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 4*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,3) = (l^2*m*cos(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 2*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*sin(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,4) = (4*b*l^3*m^2*x3*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*x3*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,5) = (2*l^2*m*x4*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,6) = (l*sin(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
df{2}{2} = fa;

% df{2}{3}
fa = sparse(4,6);
fa(3,2) = (b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*sin(x1 - x2)*cos(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (2*l^2*cos(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + 2*b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + 2*a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - 2*a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + 2*b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m*mh*sin(x1 - x2)*cos(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*sin(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,4) = (2*l^2*m*x3*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,5) = (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(3,6) = (l*sin(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,2) = (l^2*m*cos(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 2*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*sin(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,3) = (l^2*m*sin(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l^2*m*cos(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*b*l^2*m*x4^2*sin(2*x1 - 2*x2) - 2*l*u1*cos(x1 - x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2))/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (2*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,4) = (2*b*l*m*x3*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*x3*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,5) = (2*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*x4*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,6) = (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*sin(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
df{2}{3} = fa;

% df{2}{4}
fa = sparse(4,6);
fa(3,2) = (2*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*x3*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(3,3) = (2*l^2*m*x3*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,4) = -(l^2*m*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,2) = (4*b*l^3*m^2*x3*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*x3*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,3) = (2*b*l*m*x3*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*x3*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,4) = -(2*b*l*m*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
df{2}{4} = fa;

% df{2}{5}
fa = sparse(4,6);
fa(3,2) = (2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(3,3) = (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(3,5) = (2*b*sin(x1 - x2)*a^2*l*m^2 + 2*b*sin(x1 - x2)*l^3*m^2 + 2*b*mh*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(4,2) = (2*l^2*m*x4*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (2*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*x4*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,5) = (l^2*m*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
df{2}{5} = fa;

% df{2}{6}
fa = sparse(4,6);
fa(3,2) = (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*sin(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(3,3) = (l*sin(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,2) = (l*sin(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,3) = (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*sin(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
df{2}{6} = fa;

end  % if (order>=3)

if (order>=3)
% df{3}{1}{1}
fa = sparse(4,6);
df{3}{1}{1} = fa;

% df{3}{1}{2}
fa = sparse(4,6);
df{3}{1}{2} = fa;

% df{3}{1}{3}
fa = sparse(4,6);
df{3}{1}{3} = fa;

% df{3}{1}{4}
fa = sparse(4,6);
df{3}{1}{4} = fa;

% df{3}{1}{5}
fa = sparse(4,6);
df{3}{1}{5} = fa;

% df{3}{1}{6}
fa = sparse(4,6);
df{3}{1}{6} = fa;

% df{3}{2}{1}
fa = sparse(4,6);
df{3}{2}{1} = fa;

% df{3}{2}{2}
fa = sparse(4,6);
fa(3,2) = (4*b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (6*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (6*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (6*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) - a^2*b*g*m^2*sin(x1) - b*g*l^2*m^2*sin(x1) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) - b*g*l^2*m*mh*sin(x1) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (48*l^6*m^2*cos(x1 - x2)^3*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4) + (24*l^4*m*cos(x1 - x2)*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (24*l^4*m*cos(x1 - x2)^3*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (24*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (4*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) - a^2*b*g*m^2*sin(x1) - b*g*l^2*m^2*sin(x1) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) - b*g*l^2*m*mh*sin(x1) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (48*l^6*m^2*cos(x1 - x2)^3*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4) - (24*l^4*m*cos(x1 - x2)*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (24*l^4*m*cos(x1 - x2)^3*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (16*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,4) = (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,5) = (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,6) = (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,2) = (3*l^2*m*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (3*l^2*m*cos(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 8*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 8*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (12*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (12*l^4*m^2*cos(x1 - x2)^3*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (4*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (12*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (3*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 4*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (24*l^6*m^3*cos(x1 - x2)^3*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4);
fa(4,3) = (- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 8*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 4*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*m*cos(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*m*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (12*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (12*l^4*m^2*cos(x1 - x2)^3*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (4*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (2*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 2*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 4*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (24*l^6*m^3*cos(x1 - x2)^3*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4);
fa(4,4) = (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,5) = (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,6) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
df{3}{2}{2} = fa;

% df{3}{2}{3}
fa = sparse(4,6);
fa(3,2) = (4*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) - a^2*b*g*m^2*sin(x1) - b*g*l^2*m^2*sin(x1) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) - b*g*l^2*m*mh*sin(x1) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (48*l^6*m^2*cos(x1 - x2)^3*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4) - (24*l^4*m*cos(x1 - x2)*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (24*l^4*m*cos(x1 - x2)^3*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (16*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (4*b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + 2*b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + 2*b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + 2*a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + 2*b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + 2*a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + 2*b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (2*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + 2*b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + 2*a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - 2*a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + 2*b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (16*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (48*l^6*m^2*cos(x1 - x2)^3*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4) + (24*l^4*m*cos(x1 - x2)*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (24*l^4*m*cos(x1 - x2)^3*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,4) = (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,5) = (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,6) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,2) = (- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 8*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 4*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*m*cos(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*m*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (12*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (12*l^4*m^2*cos(x1 - x2)^3*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (4*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (2*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 2*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 4*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (24*l^6*m^3*cos(x1 - x2)^3*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4);
fa(4,3) = (2*l^2*m*cos(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 8*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*m*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l^2*m*cos(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (12*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (12*l^4*m^2*cos(x1 - x2)^3*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(4*b*l^2*m*x4^2*sin(2*x1 - 2*x2) - 2*l*u1*cos(x1 - x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (2*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 2*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (24*l^6*m^3*cos(x1 - x2)^3*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4);
fa(4,4) = (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,5) = (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,6) = (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
df{3}{2}{3} = fa;

% df{3}{2}{4}
fa = sparse(4,6);
fa(3,2) = (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,3) = (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,4) = (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,2) = (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,4) = (4*b*l^3*m^2*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
df{3}{2}{4} = fa;

% df{3}{2}{5}
fa = sparse(4,6);
fa(3,2) = (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,5) = (2*b*cos(x1 - x2)*a^2*l*m^2 + 2*b*cos(x1 - x2)*l^3*m^2 + 2*b*mh*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*sin(x1 - x2)*a^2*l*m^2 + 2*b*sin(x1 - x2)*l^3*m^2 + 2*b*mh*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,2) = (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,5) = (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
df{3}{2}{5} = fa;

% df{3}{2}{6}
fa = sparse(4,6);
fa(3,2) = (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,2) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,3) = (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
df{3}{2}{6} = fa;

% df{3}{3}{1}
fa = sparse(4,6);
df{3}{3}{1} = fa;

% df{3}{3}{2}
fa = sparse(4,6);
fa(3,2) = (4*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) - a^2*b*g*m^2*sin(x1) - b*g*l^2*m^2*sin(x1) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) - b*g*l^2*m*mh*sin(x1) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (48*l^6*m^2*cos(x1 - x2)^3*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4) - (24*l^4*m*cos(x1 - x2)*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (24*l^4*m*cos(x1 - x2)^3*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (16*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (4*b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + 2*b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + 2*b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + 2*a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + 2*b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + 2*a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + 2*b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (2*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + 2*b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + 2*a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - 2*a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + 2*b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (16*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (48*l^6*m^2*cos(x1 - x2)^3*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4) + (24*l^4*m*cos(x1 - x2)*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (24*l^4*m*cos(x1 - x2)^3*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,4) = (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,5) = (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,6) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,2) = (- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 8*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 4*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*m*cos(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*m*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (12*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (12*l^4*m^2*cos(x1 - x2)^3*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (4*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (2*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 2*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 4*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (24*l^6*m^3*cos(x1 - x2)^3*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4);
fa(4,3) = (2*l^2*m*cos(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 8*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*m*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l^2*m*cos(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (12*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (12*l^4*m^2*cos(x1 - x2)^3*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(4*b*l^2*m*x4^2*sin(2*x1 - 2*x2) - 2*l*u1*cos(x1 - x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (2*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 2*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (24*l^6*m^3*cos(x1 - x2)^3*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4);
fa(4,4) = (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,5) = (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,6) = (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
df{3}{3}{2} = fa;

% df{3}{3}{3}
fa = sparse(4,6);
fa(3,2) = (4*b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + 2*b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + 2*b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + 2*a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + 2*b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + 2*a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + 2*b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (2*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + 2*b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + 2*a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - 2*a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + 2*b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (16*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (48*l^6*m^2*cos(x1 - x2)^3*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4) + (24*l^4*m*cos(x1 - x2)*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (24*l^4*m*cos(x1 - x2)^3*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) + a^2*b*g*m^2*cos(x1) + b*g*l^2*m^2*cos(x1) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m*mh*cos(x1) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (6*l^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (6*l^2*cos(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + 4*b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + 4*b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + 4*a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + 4*b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + 4*a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + 4*b*g*l^2*m*mh*sin(x1 - x2)*sin(x2))/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (8*l^2*cos(x1 - x2)*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (6*l^2*cos(x1 - x2)*sin(x1 - x2)*(b*l*m*u1*cos(x1 - x2) - 2*b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2) + b*l^3*m^2*x4^2*sin(x1 - x2) + b*l^3*m*mh*x4^2*sin(x1 - x2) + a^2*b*l*m^2*x4^2*sin(x1 - x2) + 2*b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m^2*sin(x1 - x2)*cos(x2) + 2*a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - 2*a*b*g*l*m^2*sin(x1 - x2)*cos(x2) + 2*b*g*l^2*m*mh*cos(x1 - x2)*sin(x2) - 2*b*g*l^2*m*mh*sin(x1 - x2)*cos(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (24*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(b^2*l^2*m^2*x3^2*cos(2*x1 - 2*x2) + b*l*m*u1*sin(x1 - x2) - b*l^3*m^2*x4^2*cos(x1 - x2) - b*l^3*m*mh*x4^2*cos(x1 - x2) - a^2*b*l*m^2*x4^2*cos(x1 - x2) + b*g*l^2*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m^2*sin(x1 - x2)*sin(x2) + a*b*g*l*m^2*cos(x1 - x2)*cos(x2) + b*g*l^2*m*mh*cos(x1 - x2)*cos(x2) + a*b*g*l*m^2*sin(x1 - x2)*sin(x2) + b*g*l^2*m*mh*sin(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (48*l^6*m^2*cos(x1 - x2)^3*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4) - (24*l^4*m*cos(x1 - x2)*sin(x1 - x2)^3*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (24*l^4*m*cos(x1 - x2)^3*sin(x1 - x2)*(a^2*m*u1 + l^2*m*u1 + l^2*mh*u1 + (b^2*l^2*m^2*x3^2*sin(2*x1 - 2*x2))/2 - b*l*m*u1*cos(x1 - x2) - b*l^3*m^2*x4^2*sin(x1 - x2) + a^2*b*g*m^2*sin(x1) + b*g*l^2*m^2*sin(x1) - b*l^3*m*mh*x4^2*sin(x1 - x2) - a^2*b*l*m^2*x4^2*sin(x1 - x2) + b*g*l^2*m*mh*sin(x1) - b*g*l^2*m^2*cos(x1 - x2)*sin(x2) - a*b*g*l*m^2*cos(x1 - x2)*sin(x2) - b*g*l^2*m*mh*cos(x1 - x2)*sin(x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,4) = (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,5) = (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,6) = (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,2) = (2*l^2*m*cos(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 8*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l)/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*m*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l^2*m*cos(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (12*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (12*l^4*m^2*cos(x1 - x2)^3*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (l^2*m*cos(x1 - x2)*sin(x1 - x2)*(4*b*l^2*m*x4^2*sin(2*x1 - 2*x2) - 2*l*u1*cos(x1 - x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(- 2*m*cos(x1 - x2)*b^2*l*x3^2 + 2*m*cos(2*x1 - 2*x2)*b*l^2*x4^2 - 2*g*m*cos(2*x1 - x2)*b*l + 2*u1*sin(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (2*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*m*sin(x1 - x2)*b^2*l*x3^2 - 4*m*sin(2*x1 - 2*x2)*b*l^2*x4^2 + 2*g*m*sin(2*x1 - x2)*b*l + 2*u1*cos(x1 - x2)*l))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (24*l^6*m^3*cos(x1 - x2)^3*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4);
fa(4,3) = (3*l^2*m*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (3*l^2*m*cos(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (b*g*l*m*cos(2*x1 - x2) - 8*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2))/(2*b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (12*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(b*g*l*m*cos(2*x1 - x2) - 2*b*l^2*m*x4^2*cos(2*x1 - 2*x2) - 2*l*u1*sin(x1 - x2) + 2*a*b*g*m*cos(x2) + b*g*l*m*cos(x2) + 2*b*g*l*mh*cos(x2) + 2*b^2*l*m*x3^2*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) + (12*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (12*l^4*m^2*cos(x1 - x2)^3*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3) - (3*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(4*b*l^2*m*x4^2*sin(2*x1 - 2*x2) - 2*l*u1*cos(x1 - x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^2*m*cos(x1 - x2)*sin(x1 - x2)*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (24*l^6*m^3*cos(x1 - x2)^3*sin(x1 - x2)^3*(2*b*u1 - 2*l*u1*cos(x1 - x2) + b*l^2*m*x4^2*sin(2*x1 - 2*x2) - b*g*l*m*sin(2*x1 - x2) + 2*a*b*g*m*sin(x2) + b*g*l*m*sin(x2) + 2*b*g*l*mh*sin(x2) - 2*b^2*l*m*x3^2*sin(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^4);
fa(4,4) = (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,5) = (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,6) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
df{3}{3}{3} = fa;

% df{3}{3}{4}
fa = sparse(4,6);
fa(3,2) = (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,3) = (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,4) = (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,2) = (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,4) = (2*b*l*m*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
df{3}{3}{4} = fa;

% df{3}{3}{5}
fa = sparse(4,6);
fa(3,2) = (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,5) = (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*sin(x1 - x2)*a^2*l*m^2 + 2*b*sin(x1 - x2)*l^3*m^2 + 2*b*mh*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*cos(x1 - x2)*a^2*l*m^2 + 2*b*cos(x1 - x2)*l^3*m^2 + 2*b*mh*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(4,2) = (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,5) = (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
df{3}{3}{5} = fa;

% df{3}{3}{6}
fa = sparse(4,6);
fa(3,2) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,2) = (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,3) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
df{3}{3}{6} = fa;

% df{3}{4}{1}
fa = sparse(4,6);
df{3}{4}{1} = fa;

% df{3}{4}{2}
fa = sparse(4,6);
fa(3,2) = (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,3) = (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,4) = (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,2) = (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,4) = (4*b*l^3*m^2*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
df{3}{4}{2} = fa;

% df{3}{4}{3}
fa = sparse(4,6);
fa(3,2) = (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,3) = (4*l^2*m*x3*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x3*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x3*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x3*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(3,4) = (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,2) = (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (2*b*l*m*x3*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*x3*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (16*b*l^5*m^3*x3*cos(x1 - x2)^2*sin(x1 - x2)^3)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (12*b*l^3*m^2*x3*cos(x1 - x2)^2*sin(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,4) = (2*b*l*m*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
df{3}{4}{3} = fa;

% df{3}{4}{4}
fa = sparse(4,6);
fa(3,2) = (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(3,3) = (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,2) = (4*b*l^3*m^2*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*b*l*m*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
fa(4,3) = (2*b*l*m*cos(x1 - x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (4*b*l^3*m^2*cos(x1 - x2)*sin(x1 - x2)^2)/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
df{3}{4}{4} = fa;

% df{3}{4}{5}
fa = sparse(4,6);
df{3}{4}{5} = fa;

% df{3}{4}{6}
fa = sparse(4,6);
df{3}{4}{6} = fa;

% df{3}{5}{1}
fa = sparse(4,6);
df{3}{5}{1} = fa;

% df{3}{5}{2}
fa = sparse(4,6);
fa(3,2) = (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,5) = (2*b*cos(x1 - x2)*a^2*l*m^2 + 2*b*cos(x1 - x2)*l^3*m^2 + 2*b*mh*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*sin(x1 - x2)*a^2*l*m^2 + 2*b*sin(x1 - x2)*l^3*m^2 + 2*b*mh*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(4,2) = (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,5) = (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
df{3}{5}{2} = fa;

% df{3}{5}{3}
fa = sparse(4,6);
fa(3,2) = (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) + (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (2*l^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*l^2*cos(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (4*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*x4*cos(x1 - x2)*a^2*l*m^2 + 2*b*x4*cos(x1 - x2)*l^3*m^2 + 2*b*mh*x4*cos(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b*x4*sin(x1 - x2)*a^2*l*m^2 + 2*b*x4*sin(x1 - x2)*l^3*m^2 + 2*b*mh*x4*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,5) = (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*sin(x1 - x2)*a^2*l*m^2 + 2*b*sin(x1 - x2)*l^3*m^2 + 2*b*mh*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*cos(x1 - x2)*a^2*l*m^2 + 2*b*cos(x1 - x2)*l^3*m^2 + 2*b*mh*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(4,2) = (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 + (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (2*l^4*m^2*x4*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^4*m^2*x4*cos(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (4*l^2*m*x4*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) + (8*l^6*m^3*x4*cos(x1 - x2)^2*sin(x1 - x2)^2*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3 - (8*l^4*m^2*x4*cos(x1 - x2)*sin(x1 - x2)*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,5) = (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
df{3}{5}{3} = fa;

% df{3}{5}{4}
fa = sparse(4,6);
df{3}{5}{4} = fa;

% df{3}{5}{5}
fa = sparse(4,6);
fa(3,2) = (2*b*cos(x1 - x2)*a^2*l*m^2 + 2*b*cos(x1 - x2)*l^3*m^2 + 2*b*mh*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*sin(x1 - x2)*a^2*l*m^2 + 2*b*sin(x1 - x2)*l^3*m^2 + 2*b*mh*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2);
fa(3,3) = (2*l^2*cos(x1 - x2)*sin(x1 - x2)*(2*b*sin(x1 - x2)*a^2*l*m^2 + 2*b*sin(x1 - x2)*l^3*m^2 + 2*b*mh*sin(x1 - x2)*l^3*m))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (2*b*cos(x1 - x2)*a^2*l*m^2 + 2*b*cos(x1 - x2)*l^3*m^2 + 2*b*mh*cos(x1 - x2)*l^3*m)/(b^2*m*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2));
fa(4,2) = (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2) - (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2;
fa(4,3) = (2*l^4*m^2*cos(x1 - x2)*sin(x1 - x2)*sin(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2 - (2*l^2*m*cos(2*x1 - 2*x2))/(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2);
df{3}{5}{5} = fa;

% df{3}{5}{6}
fa = sparse(4,6);
df{3}{5}{6} = fa;

% df{3}{6}{1}
fa = sparse(4,6);
df{3}{6}{1} = fa;

% df{3}{6}{2}
fa = sparse(4,6);
fa(3,2) = (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,2) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,3) = (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
df{3}{6}{2} = fa;

% df{3}{6}{3}
fa = sparse(4,6);
fa(3,2) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(3,3) = (2*l^2*cos(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (2*l^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (8*l^4*m*cos(x1 - x2)^2*sin(x1 - x2)^2*(a^2*m + l^2*m + l^2*mh - b*l*m*cos(x1 - x2)))/(b^2*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,2) = (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
fa(4,3) = (l*cos(x1 - x2))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)) - (l^2*m*cos(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (l^2*m*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) - (4*l^3*m*cos(x1 - x2)*sin(x1 - x2)^2)/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^2) + (4*l^4*m^2*cos(x1 - x2)^2*sin(x1 - x2)^2*(2*b - 2*l*cos(x1 - x2)))/(b*(a^2*m + l^2*m + l^2*mh - l^2*m*cos(x1 - x2)^2)^3);
df{3}{6}{3} = fa;

% df{3}{6}{4}
fa = sparse(4,6);
df{3}{6}{4} = fa;

% df{3}{6}{5}
fa = sparse(4,6);
df{3}{6}{5} = fa;

% df{3}{6}{6}
fa = sparse(4,6);
df{3}{6}{6} = fa;

end  % if (order>=3)
